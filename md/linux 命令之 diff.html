<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"
      name="viewport"
    />
    <title>linux 命令之 diff</title>
    <link rel="shortcut icon" href="../code.svg" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/prism2.css" />
    <link rel="stylesheet" href="../css/edit.css" />
    
  </head>
  <body class="line-numbers">
    <div class="layout">
      <div class="layout__main">
        <div class="layout__main_left" style="order: 2">
          <div class="layout__main_left-switch"></div>
          <ul>
            <li class=""><a title="Motion One 一款神奇的 JavaScript 开源现代动画库" href="/md/Motion One 一款神奇的 JavaScript 开源现代动画库.html">44 Motion One 一款神奇的 JavaScript 开源现代动画库</a></li><li class=""><a title="web 端预览 Office 文件的开源项目 vue-office" href="/md/web 端预览 Office 文件的开源项目 vue-office.html">43 web 端预览 Office 文件的开源项目 vue-office</a></li><li class=""><a title="Typed.js 动态文本效果" href="/md/Typed.js 动态文本效果.html">42 Typed.js 动态文本效果</a></li><li class=""><a title="前端高颜值展示 JSON 数据" href="/md/前端高颜值展示 JSON 数据.html">41 前端高颜值展示 JSON 数据</a></li><li class=""><a title="Mock.js 前端生成模拟数据的库" href="/md/Mock.js 前端生成模拟数据的库.html">40 Mock.js 前端生成模拟数据的库</a></li><li class="active"><a title="linux 命令之 diff" href="/md/linux 命令之 diff.html">39 linux 命令之 diff</a></li><li class=""><a title="实现 github 代码对比效果，并高亮显示差异" href="/md/实现 github 代码对比效果，并高亮显示差异.html">38 实现 github 代码对比效果，并高亮显示差异</a></li><li class=""><a title="前端展示高颜值的 Excel，并支持预览、编辑" href="/md/前端展示高颜值的 Excel，并支持预览、编辑.html">37 前端展示高颜值的 Excel，并支持预览、编辑</a></li><li class=""><a title="Glide.js 一款轻量级 JavaScript 开源轮播图工具库" href="/md/Glide.js 一款轻量级 JavaScript 开源轮播图工具库.html">36 Glide.js 一款轻量级 JavaScript 开源轮播图工具库</a></li><li class=""><a title="现在前端组长都是这样做 Code Review" href="/md/现在前端组长都是这样做 Code Review.html">35 现在前端组长都是这样做 Code Review</a></li><li class=""><a title="UpSnap 搭建一款开源且精美的网络唤醒服务" href="/md/UpSnap 搭建一款开源且精美的网络唤醒服务.html">34 UpSnap 搭建一款开源且精美的网络唤醒服务</a></li><li class=""><a title="paint-board 趣味性艺术画板" href="/md/paint-board 趣味性艺术画板.html">33 paint-board 趣味性艺术画板</a></li><li class=""><a title="noUiSlider 一款轻量级的 JavaScript 开源滑块库" href="/md/noUiSlider 一款轻量级的 JavaScript 开源滑块库.html">32 noUiSlider 一款轻量级的 JavaScript 开源滑块库</a></li><li class=""><a title="granimjs 给网页背景、元素、文字添加交互式的渐变效果" href="/md/granimjs 给网页背景、元素、文字添加交互式的渐变效果.html">31 granimjs 给网页背景、元素、文字添加交互式的渐变效果</a></li><li class=""><a title="Fingerprintjs 告别隐身，浏览器指纹识别技术" href="/md/Fingerprintjs 告别隐身，浏览器指纹识别技术.html">30 Fingerprintjs 告别隐身，浏览器指纹识别技术</a></li><li class=""><a title="Dropzone 一款神奇的 JavaScript 开源文件拖拽上传库" href="/md/Dropzone 一款神奇的 JavaScript 开源文件拖拽上传库.html">29 Dropzone 一款神奇的 JavaScript 开源文件拖拽上传库</a></li><li class=""><a title="Remix，一款神奇的 JavaScript 开源全栈框架" href="/md/Remix，一款神奇的 JavaScript 开源全栈框架.html">28 Remix，一款神奇的 JavaScript 开源全栈框架</a></li><li class=""><a title="mo.js 动画库" href="/md/mo.js 动画库.html">27 mo.js 动画库</a></li><li class=""><a title="fullPage.js 创建美丽的全屏滚动网站" href="/md/fullPage.js 创建美丽的全屏滚动网站.html">26 fullPage.js 创建美丽的全屏滚动网站</a></li><li class=""><a title="以编程方式制作视频的 React 框架 Remotion" href="/md/以编程方式制作视频的 React 框架 Remotion.html">25 以编程方式制作视频的 React 框架 Remotion</a></li><li class=""><a title="Hammer.js 开源多点触摸手势库" href="/md/Hammer.js 开源多点触摸手势库.html">24 Hammer.js 开源多点触摸手势库</a></li><li class=""><a title="Gridstack.js Js 开源网格布局库" href="/md/Gridstack.js Js 开源网格布局库.html">23 Gridstack.js Js 开源网格布局库</a></li><li class=""><a title="Tesseract.js 神奇的前端 OCR 库" href="/md/Tesseract.js 神奇的前端 OCR 库.html">22 Tesseract.js 神奇的前端 OCR 库</a></li><li class=""><a title="浏览器指纹 fingerprintjs2" href="/md/浏览器指纹 fingerprintjs2.html">21 浏览器指纹 fingerprintjs2</a></li><li class=""><a title="es-toolkit 最先进的JavaScript工具库" href="/md/es-toolkit 最先进的JavaScript工具库.html">20 es-toolkit 最先进的JavaScript工具库</a></li><li class=""><a title="Chroma.js 神奇的 JavaScript 颜色处理和可视化库" href="/md/Chroma.js 神奇的 JavaScript 颜色处理和可视化库.html">19 Chroma.js 神奇的 JavaScript 颜色处理和可视化库</a></li><li class=""><a title="Reveal.js 一款神奇的 JavaScript 开源演示框架" href="/md/Reveal.js 一款神奇的 JavaScript 开源演示框架.html">18 Reveal.js 一款神奇的 JavaScript 开源演示框架</a></li><li class=""><a title="React Email 前端炫酷写邮件" href="/md/React Email 前端炫酷写邮件.html">17 React Email 前端炫酷写邮件</a></li><li class=""><a title="NProgress.js 页面进度条" href="/md/NProgress.js 页面进度条.html">16 NProgress.js 页面进度条</a></li><li class=""><a title="Paper.js 一款神奇的 JavaScript 开源矢量图库" href="/md/Paper.js 一款神奇的 JavaScript 开源矢量图库.html">15 Paper.js 一款神奇的 JavaScript 开源矢量图库</a></li><li class=""><a title="基于 Tensorflow.js 在浏览器实现图像识别" href="/md/基于 Tensorflow.js 在浏览器实现图像识别.html">14 基于 Tensorflow.js 在浏览器实现图像识别</a></li><li class=""><a title="前端实现人类动作捕捉" href="/md/前端实现人类动作捕捉.html">13 前端实现人类动作捕捉</a></li><li class=""><a title="前端图片压缩 js-image-compressor" href="/md/前端图片压缩 js-image-compressor.html">12 前端图片压缩 js-image-compressor</a></li><li class=""><a title="前端 js 动画库" href="/md/前端 js 动画库.html">11 前端 js 动画库</a></li><li class=""><a title="Rxjs 强大的异步编程解决方案" href="/md/Rxjs 强大的异步编程解决方案.html">10 Rxjs 强大的异步编程解决方案</a></li><li class=""><a title="OpenCV 前端图片磨皮处理" href="/md/OpenCV 前端图片磨皮处理.html">9 OpenCV 前端图片磨皮处理</a></li><li class=""><a title="js 运算精度丢失，用这个库试试" href="/md/js 运算精度丢失，用这个库试试.html">8 js 运算精度丢失，用这个库试试</a></li><li class=""><a title="探索 Svelte.js" href="/md/探索 Svelte.js.html">7 探索 Svelte.js</a></li><li class=""><a title="前端数据可视化常用工具大盘点" href="/md/前端数据可视化常用工具大盘点.html">6 前端数据可视化常用工具大盘点</a></li><li class=""><a title="Slidev 新一代幻灯片制作工具" href="/md/Slidev 新一代幻灯片制作工具.html">5 Slidev 新一代幻灯片制作工具</a></li><li class=""><a title="Masonry.js 轻松实现瀑布流" href="/md/Masonry.js 轻松实现瀑布流.html">4 Masonry.js 轻松实现瀑布流</a></li><li class=""><a title="Intro.js 神奇用户引导库" href="/md/Intro.js 神奇用户引导库.html">3 Intro.js 神奇用户引导库</a></li><li class=""><a title="Fuse.js 轻量高效的模糊搜索库" href="/md/Fuse.js 轻量高效的模糊搜索库.html">2 Fuse.js 轻量高效的模糊搜索库</a></li><li class=""><a title="12 个 JS 动画库" href="/md/12 个 JS 动画库.html">1 12 个 JS 动画库</a></li>
          </ul>
        </div>
        <div class="layout__main_map" style="order: 0">
          <div class="layout__main_map_content"></div>
          <div class="layout__main_map_swicth">
          </div>
        </div>
        <div
          style="order: 1"
          class="layout__main_right md "
        >
          <div class="page-header">
            <h1>linux 命令之 diff</h1>
            <p class="time">HaoTian · 2024-10-19 14:18:15</p>
          </div>
          <p><code>diff</code>命令是 Linux 和 Unix 系统中常用的文本文件比较工具，它可以比较和显示两个文件之间的差异。这个命令在软件开发、文件管理和系统配置中非常有用，尤其是在需要追踪文件变更或更新版本的情况下。</p>
<p><strong>基本用法：</strong></p>
<pre><code class="language-sh">diff [options] file1 file2
</code></pre>
<p><strong>常用参数：</strong></p>
<ul>
<li><code>-u</code>: 统一格式输出，这种格式提供了一种更连续、更易读的显示方式。它显示几行上下文，使得更改的地方更容易理解。</li>
<li><code>-c</code>: 上下文格式输出，类似于<code>-u</code>，但显示的上下文行数更多。</li>
<li><code>--ignore-case</code>: 忽略大小写差异。</li>
<li><code>-r</code>: 递归比较，用于比较目录中的所有文件。</li>
<li><code>--side-by-side</code>: 并排显示两个文件的差异。</li>
</ul>
<p><strong>使用示例：</strong></p>
<ol>
<li>基本差异比较：<code>diff old_version.txt new_version.txt</code>这条命令将输出两个文本文件之间的差异。</li>
<li>使用统一格式输出差异：<code>diff -u old_version.txt new_version.txt</code>这条命令以易于阅读的格式显示文件间的差异，包括修改的具体行和上下文。</li>
<li>忽略大小写进行比较：<code>diff --ignore-case file1.txt file2.txt</code>此命令比较两个文件时忽略大小写差异，适用于不区分大小写的文本比较。</li>
</ol>
<p><code>diff</code>命令的强大之处在于其灵活性和多样化的输出选项，使得用户可以根据需要选择最合适的比较方式。接下来的部分，我们将通过一个具体的编程问题来进一步探讨<code>diff</code>的应用。</p>
<p><strong>场景描述：</strong>  假设你是一个软件开发团队的一员，团队正在开发一个大型项目，并采用了版本控制系统来管理项目的源代码。由于项目的规模和多人协作的特性，经常会出现代码冲突和版本差异的问题。项目团队需要一种方法来快速、有效地识别不同分支或版本之间的差异，以便更好地理解各种改动，并进行有效的代码审查。</p>
<p><strong>问题详细说明：</strong>  团队中的 Alice 和 Bob 分别在自己的分支上开发新功能。当他们准备将各自的分支合并到主分支时，遇到了一些合并冲突。项目管理者要求他们提交各自分支与主分支的差异报告，以便进行代码审查和冲突解决。</p>
<p>这里的问题是，仅靠手动检查每个文件的变化是低效且容易出错的。因此，需要一个自动化的方法来生成详细的差异报告，这不仅涉及对文件内容的比较，还包括对文件存在与否的比较。</p>
<p><strong>任务：</strong></p>
<ol>
<li>使用<code>diff</code>命令对比 Alice 和 Bob 的分支与主分支之间的所有文件差异。</li>
<li>输出的报告应该包括哪些文件被修改、新增或删除，以及具体修改的内容。</li>
<li>生成的报告应该易于阅读，以便团队成员可以快速地识别关键信息。</li>
</ol>
<p>为了解决这个问题，我们将编写一个 shell 脚本，使用<code>diff</code>命令自动化这一过程，并生成一个易于理解的报告。这将帮助团队成员有效地管理和解决代码差异和冲突。</p>
<p>为了自动化比较两个代码分支与主分支之间的差异，我们将编写一个 shell 脚本。这个脚本将利用<code>diff</code>命令的功能来生成详细的差异报告，帮助开发团队快速识别代码更改。</p>
<p><strong>脚本功能：</strong>  这个脚本将自动比较指定目录（代表不同的分支）与主分支目录之间的所有文件差异，并输出一个格式化的报告。报告将包括文件差异、文件添加和删除情况。</p>
<p><strong>脚本代码：</strong></p>
<pre><code class="language-bash">#!/bin/bash

# 定义目录变量
main_branch_dir=&quot;/path/to/main/branch&quot;
feature_branch_dir=&quot;/path/to/feature/branch&quot;
diff_report=&quot;diff_report.txt&quot;

# 清空旧报告文件
&gt;$diff_report

# 比较目录并输出结果到报告文件
echo&quot;Generating diff report between feature branch and main branch...&quot;&gt;&gt;$diff_report
diff -urN $main_branch_dir$feature_branch_dir&gt;&gt;$diff_report

# 检查是否有差异
if[ $?-eq 0];then
echo&quot;No differences found.&quot;&gt;&gt;$diff_report
else
echo&quot;Differences found. See report below for details.&quot;&gt;&gt;$diff_report
fi

echo &quot;Diff report generated at: $diff_report&quot;
</code></pre>
<p><strong>脚本解释：</strong></p>
<ol>
<li><strong>定义目录变量：</strong>  脚本开始部分定义了两个变量，<code>main_branch_dir</code>和<code>feature_branch_dir</code>，分别存储主分支和特性分支的目录路径。</li>
<li><strong>清空旧报告文件：</strong>  使用<code>&gt; $diff_report</code>命令清空之前的报告内容，确保每次生成的报告都是最新的。</li>
<li><strong>生成比较报告：</strong>  使用<code>echo</code>命令向报告文件添加一行文本，说明正在生成报告。<code>diff -urN $main_branch_dir $feature_branch_dir &gt;&gt; $diff_report</code>命令则执行实际的目录比较，其中：</li>
</ol>
<ul>
<li><code>-u</code>表示生成统一的差异输出，便于阅读。</li>
<li><code>-r</code>表示递归比较所有子目录和文件。</li>
<li><code>-N</code>对于不存在的文件，假设其全部内容为空，使得新增文件也能在报告中显示其全部内容。</li>
<li>输出重定向到报告文件<code>$diff_report</code>中。</li>
</ul>
<ol start="5">
<li><strong>检查差异存在与否：</strong>  通过检查<code>diff</code>命令的退出状态（<code>$?</code>），如果状态为 0（无差异），则向报告文件添加“无差异”信息；如果状态非 0（存在差异），则添加一行说明已找到差异，并提示查看报告文件了解详细信息。</li>
<li><strong>报告生成位置提示：</strong>  最后一行<code>echo</code>命令输出报告文件的生成位置，让用户知道从哪里可以查看报告。</li>
</ol>
<p><strong>脚本运行结果：</strong>  当脚本运行完成后，它会生成一个名为<code>diff_report.txt</code>的文件，包含了从主分支到特性分支的全部文件差异。如果两个分支之间有差异，报告将详细列出每个文件的不同，包括新增的行、删除的行以及修改的行。如果没有发现任何差异，报告中会明确指出。</p>
<p>这个脚本为开发团队提供了一个强大的工具，用于自动化地检测和记录代码版本之间的差异，极大地简化了代码审查和合并过程。</p>
<p>在本文中，我们详细探讨了 Linux <code>diff</code>命令的功能和应用。通过分析命令的基本用法和常用参数，我们可以看到<code>diff</code>是一个强大的工具，专为比较文件内容设计，非常适合软件开发和代码管理中的需求。</p>
<p><strong>关键总结点：</strong></p>
<ol>
<li><strong>多功能性：</strong> <code>diff</code>命令支持多种格式和选项，如统一格式(<code>-u</code>)和递归比较(<code>-r</code>)，使得它可以灵活应对不同的比较需求。</li>
<li><strong>实际应用：</strong>  通过构造的场景，我们展示了<code>diff</code>命令在实际开发工作中的应用，特别是在处理多版本代码比较时的有效性。自动化脚本进一步提升了其实用性，帮助开发团队高效地管理和审查代码差异。</li>
<li><strong>脚本功能：</strong>  提供的 shell 脚本示例不仅自动化了比较过程，还通过递归比较和格式化输出增强了用户的工作效率。这种自动化工具对于保持代码质量和简化开发流程至关重要。</li>
</ol>
<p>通过学习和使用<code>diff</code>命令，开发人员可以更有效地追踪和管理文件更改，减少错误和冲突的可能性。此外，了解如何通过编写脚本来利用这些命令，可以大大提高工作效率和自动化程度。</p>

        </div>
      </div>
    </div>
    <div class="body_bg"></div>
    <script defer src="../js/prism.min.js"></script>
    <script>
      const liActive = document.querySelector(".layout__main_left li.active");
      liActive.scrollIntoView({
        behavior: "smooth",
        block: "center",
        inline: "nearest",
      });
      const imgs = document.querySelectorAll("img");
      imgs.forEach((img) => {
        img.onclick = () => {
          img.style.opacity = 0;
          let imgHove = document.querySelector(".img-hover");
          if (imgHove) imgHove.remove();
          const src = img.src;
          const html = `
            <div class="img-hover">
              <img src="${src}" />
            </div>
          `;
          document.body.insertAdjacentHTML("beforeend", html);
          document.body.style.overflow = "hidden";
          imgHove = document.querySelector(".img-hover");
          imgHove.onclick = () => {
            imgHove.remove();
            document.body.style.overflow = "initial";
            img.style.opacity = 1;
          };
        };
      });
      const headings = document.querySelectorAll(".md h2, .md h3");
      const navContainer = document.querySelector(".layout__main_map_content");
      const layoutMainMap = document.querySelector(".layout__main_map");
      if (!headings?.length) {
        layoutMainMap.style.display = "none";
      }
      headings.forEach((heading, index) => {
        const id = `heading-${index}`;
        heading.id = id;
        const link = document.createElement("a");
        link.href = `#${id}`;
        link.textContent =
          heading.tagName === "H2"
            ? `▪ ${heading.textContent}`
            : `· ${heading.textContent}`;
        link.title = link.textContent;
        link.style.display = "block";
        link.style.margin = "5px 0";
        link.style.color = heading.tagName === "H2" ? "blue" : "darkblue";
        link.style.cursor = "pointer";
        link.className = heading.tagName === "H2" ? "H2" : "H3";
        link.addEventListener("click", (event) => {
          event.preventDefault();
          document.getElementById(id).scrollIntoView({ behavior: "smooth" });
        });
        navContainer.appendChild(link);
      });
      const swicthDom = document.querySelector(".layout__main_map_swicth");
      const mapDom = document.querySelector(".layout__main_map");
      swicthDom.onclick = () => {
        mapDom.classList.toggle("show");
      };
      const swicthDom2 = document.querySelector(".layout__main_left-switch");
      const mapDom2 = document.querySelector(".layout__main_left");
      swicthDom2.onclick = () => {
        mapDom2.classList.toggle("show");
      };
    </script>
  </body>
</html>

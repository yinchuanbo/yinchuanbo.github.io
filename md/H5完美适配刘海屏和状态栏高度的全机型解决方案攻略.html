<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"
      name="viewport"
    />
    <title>H5完美适配刘海屏和状态栏高度的全机型解决方案攻略</title>
    <link rel="shortcut icon" href="../code.svg" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/prism.css" />
    <link rel="stylesheet" href="../css/edit.css" />
    
  </head>
  <body class="line-numbers">
    <div class="layout">
      <div class="layout__main">
        <div class="layout__main_left" style="order: 2">
          <ul>
            <li class=""><a title="阻止关闭或刷新浏览器" href="/md/阻止关闭或刷新浏览器.html">12 阻止关闭或刷新浏览器</a></li><li class=""><a title="开发 H5 遇到的一些问题" href="/md/开发 H5 遇到的一些问题.html">11 开发 H5 遇到的一些问题</a></li><li class=""><a title="并不是所有的 mp4 视频都能被 video 标签播放" href="/md/并不是所有的 mp4 视频都能被 video 标签播放.html">10 并不是所有的 mp4 视频都能被 video 标签播放</a></li><li class=""><a title="页面关闭时如何成功发送 API 请求" href="/md/页面关闭时如何成功发送 API 请求.html">9 页面关闭时如何成功发送 API 请求</a></li><li class=""><a title="解决 ios audio 无法自动播放、循环播放的问题" href="/md/解决 ios audio 无法自动播放、循环播放的问题.html">8 解决 ios audio 无法自动播放、循环播放的问题</a></li><li class=""><a title="浏览器保存密码后自动填充问题" href="/md/浏览器保存密码后自动填充问题.html">7 浏览器保存密码后自动填充问题</a></li><li class=""><a title="当网页资源加载失败时，怎么处理" href="/md/当网页资源加载失败时，怎么处理.html">6 当网页资源加载失败时，怎么处理</a></li><li class=""><a title="实现页面刷新后不定位到之前的滚动位置" href="/md/实现页面刷新后不定位到之前的滚动位置.html">5 实现页面刷新后不定位到之前的滚动位置</a></li><li class=""><a title="前端字体渲染闪烁问题" href="/md/前端字体渲染闪烁问题.html">4 前端字体渲染闪烁问题</a></li><li class=""><a title="window.open 弹窗被阻止解决方案" href="/md/window.open 弹窗被阻止解决方案.html">3 window.open 弹窗被阻止解决方案</a></li><li class=""><a title="IOS 手机容器滚动条滑动不流畅" href="/md/IOS 手机容器滚动条滑动不流畅.html">2 IOS 手机容器滚动条滑动不流畅</a></li><li class="active"><a title="H5完美适配刘海屏和状态栏高度的全机型解决方案攻略" href="/md/H5完美适配刘海屏和状态栏高度的全机型解决方案攻略.html">1 H5完美适配刘海屏和状态栏高度的全机型解决方案攻略</a></li>
          </ul>
        </div>
        <div class="layout__main_map" style="order: 0">
          <div class="layout__main_map_content"></div>
          <div class="layout__main_map_swicth"></div>
        </div>
        <div
          style="order: 1"
          class="layout__main_right md "
        >
          <h1>H5完美适配刘海屏和状态栏高度的全机型解决方案攻略</h1>
          <p class="time">HaoTian · 2024-08-30 17:34:29</p>
          <img src="../imgs/15/01.png" />

<h2>iOS 平台适配方法：</h2>
<h3>利用<code>window.visualViewport</code>获取状态栏高度</h3>
<p>在 iOS 平台上，我们可以借助<code>window.visualViewport</code>对象来获取状态栏高度。下面是示例代码：</p>
<pre><code class="language-js">const statusBarHeight = window.visualViewport.offsetTop;
console.log(&quot;状态栏高度：&quot;, statusBarHeight);
</code></pre>
<p>这段代码将输出状态栏的高度，让你可以根据需要进行相应的适配操作。</p>
<h2>安卓平台适配方法：</h2>
<h3>使用<code>window.screen</code>属性及媒体查询检测刘海屏及计算状态栏高度</h3>
<p>对于安卓平台，我们可以使用<code>window.screen</code>属性来计算刘海屏和状态栏高度。同时，通过媒体查询的方式检测是否存在刘海屏。下面是示例代码：</p>
<pre><code class="language-js">const devicePixelRatio = window.devicePixelRatio;
const screenHeight = window.screen.height;
let statusBarHeight = 0;
if (window.matchMedia(&quot;(display-cutout: constant)&quot;).matches) {
  statusBarHeight = Math.round(24 * devicePixelRatio); // 这里的24需要根据设备实际情况进行调整
}
console.log(&quot;状态栏高度：&quot;, statusBarHeight);
</code></pre>
<p>这段代码将获取设备的像素比和屏幕高度，并根据媒体查询检测刘海屏，并计算出状态栏的高度。</p>
<h2>综合适配方案：</h2>
<h3>通用方法封装及异常情况处理</h3>
<p>为了实现更好的代码复用性，我们可以封装通用方法来获取状态栏高度，并处理异常情况。下面是示例代码：</p>
<pre><code class="language-js">function getStatusBarHeight() {
  let statusBarHeight = 0;
  if (window.visualViewport) {
    statusBarHeight = window.visualViewport.offsetTop;
  } else if (
    window.screen &amp;&amp;
    window.matchMedia(&quot;(display-cutout: constant)&quot;).matches
  ) {
    const devicePixelRatio = window.devicePixelRatio;
    const screenHeight = window.screen.height;
    statusBarHeight = Math.round(24 * devicePixelRatio); // 这里的24需要根据设备实际情况进行调整
  }
  return statusBarHeight;
}
const statusBarHeight = getStatusBarHeight();
console.log(&quot;状态栏高度：&quot;, statusBarHeight);
</code></pre>
<p>通过封装通用方法，你可以在不同平台下使用同一段代码来获取状态栏高度，并在异常情况下提供默认高度。</p>
<h2>插件和库应用</h2>
<h3>深入介绍<code>cordova-plugin-statusbar</code>与<code>react-native-safe-area-context</code></h3>
<p>对于更精确的适配方案，你可以借助一些插件和库来简化开发工作。<code>cordova-plugin-statusbar</code>和<code>react-native-safe-area-context</code>是两个非常常用的工具，它们提供了更多功能和更精细的控制。你可以根据项目的需要选择合适的插件和库，并参考官方文档进行使用。</p>
<h2>深度探索：高级技巧与解决方案实践</h2>
<p>掌握了基本的适配技巧后，你可以进一步深入探索一些高级技巧和解决方案。例如，你可以根据不同设备的刘海屏形状和位置，调整布局和样式，以便更好地适配。此外，你还可以利用动态计算和过渡效果来提升用户体验，使应用在刘海屏和状态栏高度变化时能平滑过渡。</p>
<p>在实践中，你还可以探索一些第三方库和工具，如<code>@react-native-community/react-native-safe-area-context</code>和<code>vue-safe-area-mixin</code>等，它们提供了更便捷的适配方案，让你能更加专注于业务逻辑的开发。</p>
<h2>结论：总结适配挑战与选择合适方案的重要性</h2>
<p>适配刘海屏和状态栏高度对于保证应用的美观和用户体验至关重要。通过本文分享的解决方案和技巧，你可以轻松应对各种全机型的适配挑战。</p>
<p>在选择适配方案时，根据应用类型和目标平台选择合适的解决方案是至关重要的。借助通用方法的封装和插件库的应用，你可以更高效地完成适配工作，并且还可以针对特定情况进行深度探索和优化。</p>

        </div>
        <div class="nav__bar">
          <button onclick="location.href='/md'">
            <svg
              t="1731313267148"
              class="icon"
              viewBox="0 0 1024 1024"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              p-id="5167"
              width="30"
              height="30"
            >
              <path
                d="M902.268 514.39L511.236 216.342 120.203 514.39l-56.166-73.688L511.236 99.843l447.198 340.859z"
                fill="#0000ff"
                p-id="5168"
              ></path>
              <path
                d="M513.985 329.359L192 565.269v267.735C192 862.683 216.589 887 246.268 887H413V623h195v264h168.93c29.679 0 53.07-24.317 53.07-53.996V565.269l-316.015-235.91z"
                fill="#BDCCD4"
                p-id="5169"
              ></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
    <div class="body_bg"></div>
    <script defer src="../js/prism.min.js"></script>
    <script>
      const liActive = document.querySelector(".layout__main_left li.active");
      liActive.scrollIntoView({
        behavior: "smooth",
        block: "center",
        inline: "nearest",
      });
      const imgs = document.querySelectorAll("img");
      imgs.forEach((img) => {
        img.onclick = () => {
          img.style.opacity = 0;
          let imgHove = document.querySelector(".img-hover");
          if (imgHove) imgHove.remove();
          const src = img.src;
          const html = `
            <div class="img-hover">
              <img src="${src}" />
            </div>
          `;
          document.body.insertAdjacentHTML("beforeend", html);
          document.body.style.overflow = "hidden";
          imgHove = document.querySelector(".img-hover");
          imgHove.onclick = () => {
            imgHove.remove();
            document.body.style.overflow = "initial";
            img.style.opacity = 1;
          };
        };
      });
      const headings = document.querySelectorAll(".md h2, .md h3");
      const navContainer = document.querySelector(".layout__main_map_content");
      const layoutMainMap = document.querySelector(".layout__main_map");
      if (!headings?.length) {
        layoutMainMap.style.display = "none";
      }
      headings.forEach((heading, index) => {
        const id = `heading-${index}`;
        heading.id = id;
        const link = document.createElement("a");
        link.href = `#${id}`;
        link.textContent =
          heading.tagName === "H2"
            ? `${heading.textContent}`
            : `· ${heading.textContent}`;
        link.style.display = "block";
        link.style.margin = "5px 0";
        link.style.color = heading.tagName === "H2" ? "blue" : "darkblue";
        link.style.cursor = "pointer";
        link.className = heading.tagName === "H2" ? "H2" : "H3";
        link.addEventListener("click", (event) => {
          event.preventDefault();
          document.getElementById(id).scrollIntoView({ behavior: "smooth" });
        });
        navContainer.appendChild(link);
      });
      const swicthDom = document.querySelector(".layout__main_map_swicth");
      const mapDom = document.querySelector(".layout__main_map");
      swicthDom.onclick = () => {
        mapDom.classList.toggle("show");
      };
    </script>
  </body>
</html>

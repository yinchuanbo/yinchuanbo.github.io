<!DOCTYPE html>
<html lang="en" class="">
  <head>
    <meta charset="UTF-8" />
    <meta
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"
      name="viewport"
    />
    <title>前端 reduce 函数100 种使用方法整理</title>
    <link rel="shortcut icon" href="../code.svg" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=fallback"
      rel="stylesheet"
    />
    <link id="prismTheme" rel="stylesheet" href="../css/prism.css" />
    <link rel="stylesheet" href="../css/edit.css" />
    
    <style>
      /* Animation Styles */
      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .slide-in {
        animation: slideIn 0.5s ease;
      }

      @keyframes slideIn {
        from {
          transform: translateY(-20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .button {
        transition: background-color 0.3s, transform 0.3s;
      }

      .button:hover {
        background-color: #3700b3;
        transform: scale(1.05);
      }

      /* Tooltip Styles */
      .tooltip {
        position: relative;
        display: inline-block;
      }

      .tooltip .tooltiptext {
        visibility: hidden;
        width: 120px;
        background-color: black;
        color: #fff;
        text-align: center;
        border-radius: 5px;
        padding: 5px 0;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        margin-left: -60px;
        opacity: 0;
        transition: opacity 0.3s;
      }

      .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
      }
    </style>
  </head>

  <body class="fade-in">
    <button
      class="toggle-sidebar"
      id="toggleSidebar"
      aria-label="Toggle Sidebar"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>

    <div class="app-container">
      <!-- Sidebar Navigation -->
      <nav class="sidebar">
        <div class="sidebar-content">
          <div class="nav-section"><li class=""><a title="15个 JavaScript 代码规范" href="/md/15个 JavaScript 代码规范.html"><span>60</span> 15个 JavaScript 代码规范</a></li><li class=""><a title="8个 JavaScript 错误处理技巧 Bug 减少百分之 75" href="/md/8个 JavaScript 错误处理技巧 Bug 减少百分之 75.html"><span>59</span> 8个 JavaScript 错误处理技巧 Bug 减少百分之 75</a></li><li class=""><a title="WebWorker、SharedWorker 和 ServiceWorker 还在傻傻分不清" href="/md/WebWorker、SharedWorker 和 ServiceWorker 还在傻傻分不清.html"><span>58</span> WebWorker、SharedWorker 和 ServiceWorker 还在傻傻分不清</a></li><li class=""><a title="用 JavaScript 实现 Live2D 虚拟人口型同步" href="/md/用 JavaScript 实现 Live2D 虚拟人口型同步.html"><span>57</span> 用 JavaScript 实现 Live2D 虚拟人口型同步</a></li><li class=""><a title="ES6 中引入的 new.target 你知道吗" href="/md/ES6 中引入的 new.target 你知道吗.html"><span>56</span> ES6 中引入的 new.target 你知道吗</a></li><li class=""><a title="ES 新特性全解密" href="/md/ES 新特性全解密.html"><span>55</span> ES 新特性全解密</a></li><li class="active"><a title="前端 reduce 函数100 种使用方法整理" href="/md/前端 reduce 函数100 种使用方法整理.html"><span>54</span> 前端 reduce 函数100 种使用方法整理</a></li><li class=""><a title="proxy 和 Object.defineProperty()" href="/md/proxy 和 Object.defineProperty().html"><span>53</span> proxy 和 Object.defineProperty()</a></li><li class=""><a title="为何说 AbortController 是前端一把利剑" href="/md/为何说 AbortController 是前端一把利剑.html"><span>52</span> 为何说 AbortController 是前端一把利剑</a></li><li class=""><a title="前端 Money 类" href="/md/前端 Money 类.html"><span>51</span> 前端 Money 类</a></li><li class=""><a title="理解JS里的WeakMap" href="/md/理解JS里的WeakMap.html"><span>50</span> 理解JS里的WeakMap</a></li><li class=""><a title="token无感刷新的基本实现" href="/md/token无感刷新的基本实现.html"><span>49</span> token无感刷新的基本实现</a></li><li class=""><a title="前端中的 File 和 Blob两个对象到底有什么不同" href="/md/前端中的 File 和 Blob两个对象到底有什么不同.html"><span>48</span> 前端中的 File 和 Blob两个对象到底有什么不同</a></li><li class=""><a title="js 检测网页空闲状态(一定时间内无操作)" href="/md/js 检测网页空闲状态(一定时间内无操作).html"><span>47</span> js 检测网页空闲状态(一定时间内无操作)</a></li><li class=""><a title="Javascirpt 时区" href="/md/Javascirpt 时区.html"><span>46</span> Javascirpt 时区</a></li><li class=""><a title="实用的 Javascript 小功能" href="/md/实用的 Javascript 小功能.html"><span>45</span> 实用的 Javascript 小功能</a></li><li class=""><a title="前端实现直接粘贴图片到 html 页面" href="/md/前端实现直接粘贴图片到 html 页面.html"><span>44</span> 前端实现直接粘贴图片到 html 页面</a></li><li class=""><a title="前端如何静悄悄录制用户的操作过程，静悄悄上传到服务器" href="/md/前端如何静悄悄录制用户的操作过程，静悄悄上传到服务器.html"><span>43</span> 前端如何静悄悄录制用户的操作过程，静悄悄上传到服务器</a></li><li class=""><a title="JS 中数组的 map 鲜为人知但绝妙的使用方法" href="/md/JS 中数组的 map 鲜为人知但绝妙的使用方法.html"><span>42</span> JS 中数组的 map 鲜为人知但绝妙的使用方法</a></li><li class=""><a title="在 Web 中判断页面是不是刷新" href="/md/在 Web 中判断页面是不是刷新.html"><span>41</span> 在 Web 中判断页面是不是刷新</a></li><li class=""><a title="Js 小技巧" href="/md/Js 小技巧.html"><span>40</span> Js 小技巧</a></li><li class=""><a title="split 方法我算是白学了" href="/md/split 方法我算是白学了.html"><span>39</span> split 方法我算是白学了</a></li><li class=""><a title="拼接 URL" href="/md/拼接 URL.html"><span>38</span> 拼接 URL</a></li><li class=""><a title="ES14 中 5 个最具变革性的 JavaScript 特性" href="/md/ES14 中 5 个最具变革性的 JavaScript 特性.html"><span>37</span> ES14 中 5 个最具变革性的 JavaScript 特性</a></li><li class=""><a title="JavaScript 中设置器和获取器" href="/md/JavaScript 中设置器和获取器.html"><span>36</span> JavaScript 中设置器和获取器</a></li><li class=""><a title="非常强大的标准 JavaScript API - AbortController" href="/md/非常强大的标准 JavaScript API - AbortController.html"><span>35</span> 非常强大的标准 JavaScript API - AbortController</a></li><li class=""><a title="掌握 JavaScript 中的 Call 和 Apply" href="/md/掌握 JavaScript 中的 Call 和 Apply.html"><span>34</span> 掌握 JavaScript 中的 Call 和 Apply</a></li><li class=""><a title="一文整懂事件对象 event 的常用方法" href="/md/一文整懂事件对象 event 的常用方法.html"><span>33</span> 一文整懂事件对象 event 的常用方法</a></li><li class=""><a title="7 种开发人员都应该知道的高级 JavaScript 技术" href="/md/7 种开发人员都应该知道的高级 JavaScript 技术.html"><span>32</span> 7 种开发人员都应该知道的高级 JavaScript 技术</a></li><li class=""><a title="实现基于用户操作系统偏好的明暗主题切换" href="/md/实现基于用户操作系统偏好的明暗主题切换.html"><span>31</span> 实现基于用户操作系统偏好的明暗主题切换</a></li><li class=""><a title="JavaScript 原生实现图片复制与粘贴" href="/md/JavaScript 原生实现图片复制与粘贴.html"><span>30</span> JavaScript 原生实现图片复制与粘贴</a></li><li class=""><a title="高精度实现定时器" href="/md/高精度实现定时器.html"><span>29</span> 高精度实现定时器</a></li><li class=""><a title="获取上传进度的几种方式" href="/md/获取上传进度的几种方式.html"><span>28</span> 获取上传进度的几种方式</a></li><li class=""><a title="聊聊禁止页面滚动的几种方法" href="/md/聊聊禁止页面滚动的几种方法.html"><span>27</span> 聊聊禁止页面滚动的几种方法</a></li><li class=""><a title="缓存 http 错误，避免多次报错提示" href="/md/缓存 http 错误，避免多次报错提示.html"><span>26</span> 缓存 http 错误，避免多次报错提示</a></li><li class=""><a title="文件操作" href="/md/文件操作.html"><span>25</span> 文件操作</a></li><li class=""><a title="数据类型判断方法" href="/md/数据类型判断方法.html"><span>24</span> 数据类型判断方法</a></li><li class=""><a title="宏任务和微任务" href="/md/宏任务和微任务.html"><span>23</span> 宏任务和微任务</a></li><li class=""><a title="十个超级好用的 Js 技巧" href="/md/十个超级好用的 Js 技巧.html"><span>22</span> 十个超级好用的 Js 技巧</a></li><li class=""><a title="前端的网络状态" href="/md/前端的网络状态.html"><span>21</span> 前端的网络状态</a></li><li class=""><a title="使用 JavaScript 加载字体" href="/md/使用 JavaScript 加载字体.html"><span>20</span> 使用 JavaScript 加载字体</a></li><li class=""><a title="你需要知道的 Symbols" href="/md/你需要知道的 Symbols.html"><span>19</span> 你需要知道的 Symbols</a></li><li class=""><a title="Set 和 WeakSet 的用法和区别" href="/md/Set 和 WeakSet 的用法和区别.html"><span>18</span> Set 和 WeakSet 的用法和区别</a></li><li class=""><a title="sessionStorage 能在多个标签页之间共享数据吗" href="/md/sessionStorage 能在多个标签页之间共享数据吗.html"><span>17</span> sessionStorage 能在多个标签页之间共享数据吗</a></li><li class=""><a title="scrollIntoview" href="/md/scrollIntoview.html"><span>16</span> scrollIntoview</a></li><li class=""><a title="reduce 的高级用法" href="/md/reduce 的高级用法.html"><span>15</span> reduce 的高级用法</a></li><li class=""><a title="js 小众且好用的技巧" href="/md/js 小众且好用的技巧.html"><span>14</span> js 小众且好用的技巧</a></li><li class=""><a title="js 如何监听一个变量改变" href="/md/js 如何监听一个变量改变.html"><span>13</span> js 如何监听一个变量改变</a></li><li class=""><a title="javascript 奇葩行为大赏" href="/md/javascript 奇葩行为大赏.html"><span>12</span> javascript 奇葩行为大赏</a></li><li class=""><a title="FileReader" href="/md/FileReader.html"><span>11</span> FileReader</a></li><li class=""><a title="EventSource" href="/md/EventSource.html"><span>10</span> EventSource</a></li><li class=""><a title="document.referrer 拦截问题" href="/md/document.referrer 拦截问题.html"><span>09</span> document.referrer 拦截问题</a></li><li class=""><a title="7 个 Promise 静态方法" href="/md/7 个 Promise 静态方法.html"><span>08</span> 7 个 Promise 静态方法</a></li><li class=""><a title="谈谈前端路由的实现原理 hash ＆ history" href="/md/谈谈前端路由的实现原理 hash ＆ history.html"><span>07</span> 谈谈前端路由的实现原理 hash ＆ history</a></li><li class=""><a title="属性的 getter 和 setter" href="/md/属性的 getter 和 setter.html"><span>06</span> 属性的 getter 和 setter</a></li><li class=""><a title="高效检查 JS 对象中的键是否存在" href="/md/高效检查 JS 对象中的键是否存在.html"><span>05</span> 高效检查 JS 对象中的键是否存在</a></li><li class=""><a title="实现鼠标滚轮缩放 SVG 内容" href="/md/实现鼠标滚轮缩放 SVG 内容.html"><span>04</span> 实现鼠标滚轮缩放 SVG 内容</a></li><li class=""><a title="使用 JS 向现有 SVG 中添加元素" href="/md/使用 JS 向现有 SVG 中添加元素.html"><span>03</span> 使用 JS 向现有 SVG 中添加元素</a></li><li class=""><a title="JS 单行代码集" href="/md/JS 单行代码集.html"><span>02</span> JS 单行代码集</a></li><li class=""><a title="7 种位运算符的神奇用法" href="/md/7 种位运算符的神奇用法.html"><span>01</span> 7 种位运算符的神奇用法</a></li></div>
        </div>
      </nav>

      <!-- Main Content Area -->
      <main class="main-content">
        <header class="content-header">
          <div class="header-left">
            <h1 class="page-title">前端 reduce 函数100 种使用方法整理</h1>
            <p class="time">HaoTian · 2025-01-08 09:37:11</p>
          </div>
          <div class="header-right">
            <div class="tag-container">
              <span class="tag">JavaScript</span>
            </div>
            <button
              id="themeToggle"
              class="theme-toggle"
              aria-label="Toggle theme"
            >
              <svg
                class="sun-icon"
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
              <svg
                class="moon-icon"
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                ></path>
              </svg>
            </button>
            <button
              class="theme-toggle"
              aria-label="Toggle theme"
              style="width: 36px; height: 36px"
              onclick="window.location.href='/md';"
            >
              <svg
                t="1737442501710"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="5258"
                width="20"
                height="20"
              >
                <path
                  d="M883.773793 626.047476c-17.308201 0-31.408337 14.029528-31.408337 31.304983l0 207.437469c0 17.204847-14.098089 31.302937-31.406291 31.302937L203.040834 896.092865c-17.340947 0-31.408337-14.098089-31.408337-31.302937L171.632497 657.352459c0-17.275455-14.099113-31.304983-31.408337-31.304983-17.380856 0-31.444153 14.029528-31.444153 31.304983l0 207.437469c0 51.773154 42.261523 93.91188 94.260827 93.91188l617.918331 0c52.031027 0 94.259804-42.139749 94.259804-93.91188L915.21897 657.352459C915.21897 640.077004 901.152603 626.047476 883.773793 626.047476L883.773793 626.047476zM230.262826 614.286618c55.523571 0 104.556311-27.674293 134.394896-69.762877 32.487925 46.451962 86.303598 77.0744 147.343813 77.0744 61.036122 0 114.846678-30.623461 147.306974-77.0744 29.943986 42.018999 78.902024 69.762877 134.426619 69.762877 90.948385 0 164.968216-73.77526 164.968216-164.371628 0-11.062963-2.342348-22.859637-5.130857-35.178197-0.209778-1.134847 0.031722-2.26867-0.277316-3.38612l-0.629333-2.267647c-0.24764-0.924045-0.140193-1.535983-0.352017-2.547009-0.138146-0.505513-0.521886-0.87288-0.695848-1.39579l-85.364203-316.671313c-3.699252-13.645788-16.051581-23.172769-30.293957-23.172769L187.965487 65.296145c-14.238282 0-26.665313 9.526981-30.360472 23.24133L72.309374 405.1566c-0.103354 0.50756-0.48607 0.820692-0.62524 1.309832-0.210801 0.942465-0.107447 1.639337-0.349971 2.511193l-0.62524 2.373047c-0.318248 1.11745 0 2.25025-0.210801 3.38612-2.863211 12.31856-5.201465 24.115234-5.201465 35.178197C65.295634 540.511357 139.315464 614.286618 230.262826 614.286618L230.262826 614.286618z"
                  fill="currentColor"
                  p-id="5259"
                ></path>
              </svg>
            </button>
          </div>
        </header>

        <!-- Article Content -->
        <article
          class="content-body md md "
        >
          <h2>reduce 函数概述</h2>
<p><code>reduce</code> 是 JavaScript 数组的一个高阶函数，它对数组中的每个元素执行一个由你提供的“reducer”回调函数，将其结果汇总为单个返回值。<code>reduce</code> 函数的核心思想是将数组中的多个值“归约”为一个值。</p>
<h2>reduce 函数的语法</h2>
<pre><code class="language-js">array.reduce(reducerFunction, initialValue);
</code></pre>
<ul>
<li><p><code>reducerFunction</code>: 一个回调函数，它接收四个参数：</p>
<ul>
<li><code>accumulator</code>: 累加器，它会累积回调函数的返回值。它是上一次回调函数返回的值，或者是 <code>initialValue</code>（如果提供了）。</li>
<li><code>currentValue</code>: 当前正在处理的数组元素。</li>
<li><code>currentIndex</code>: 当前正在处理的数组元素的索引。</li>
<li><code>array</code>: 调用 <code>reduce</code> 的数组本身。</li>
</ul>
</li>
<li><p><code>initialValue</code>: 可选参数，作为第一次调用 <code>reducerFunction</code> 时 <code>accumulator</code> 的初始值。如果未提供，则使用数组的第一个元素作为初始值，并且会跳过第一个元素。</p>
</li>
</ul>
<h2>reduce 函数的工作原理</h2>
<ol>
<li><strong>初始化:</strong><ul>
<li>如果提供了 <code>initialValue</code>，则 <code>accumulator</code> 初始化为 <code>initialValue</code>，并且 <code>reducerFunction</code> 从数组的第一个元素开始执行。</li>
<li>如果没有提供 <code>initialValue</code>，则 <code>accumulator</code> 初始化为数组的第一个元素，并且 <code>reducerFunction</code> 从数组的第二个元素开始执行。</li>
</ul>
</li>
<li><strong>迭代:</strong><ul>
<li><code>reducerFunction</code> 会遍历数组中的每个元素（或从第二个元素开始，如果没有 <code>initialValue</code>）。</li>
<li>在每次迭代中，<code>reducerFunction</code> 会被调用，并接收 <code>accumulator</code>、<code>currentValue</code>、<code>currentIndex</code> 和 <code>array</code> 作为参数。</li>
<li><code>reducerFunction</code> 的返回值会成为下一次迭代的 <code>accumulator</code>。</li>
</ul>
</li>
<li><strong>返回结果:</strong><ul>
<li>当数组中的所有元素都被处理完毕后，<code>reduce</code> 函数会返回最终的 <code>accumulator</code> 的值。</li>
</ul>
</li>
</ol>
<h2>reduce 函数的常见用途</h2>
<ol>
<li><strong>求和:</strong> 计算数组中所有元素的总和。</li>
<li><strong>求积:</strong> 计算数组中所有元素的乘积。</li>
<li><strong>查找最大值/最小值:</strong> 找出数组中的最大值或最小值。</li>
<li><strong>数组扁平化:</strong> 将多维数组转换为一维数组。</li>
<li><strong>对象属性计数:</strong> 统计数组中对象属性的出现次数。</li>
<li><strong>分组数据:</strong> 根据特定条件将数组中的元素分组。</li>
<li><strong>管道操作:</strong> 将多个函数串联起来处理数据。</li>
</ol>
<h2>代码示例</h2>
<p>涵盖了 <code>reduce</code> 函数的各种用途，并附有详细的注释。</p>
<pre><code class="language-js">// 1. 求和
function sumArray(arr) {
  return arr.reduce(
    (accumulator, currentValue) =&gt; accumulator + currentValue,
    0
  );
}

const numbers = [1, 2, 3, 4, 5];
console.log(&quot;1. 求和:&quot;, sumArray(numbers)); // 输出: 15

// 2. 求积
function productArray(arr) {
  return arr.reduce(
    (accumulator, currentValue) =&gt; accumulator * currentValue,
    1
  );
}

console.log(&quot;2. 求积:&quot;, productArray(numbers)); // 输出: 120

// 3. 查找最大值
function findMax(arr) {
  return arr.reduce((accumulator, currentValue) =&gt;
    Math.max(accumulator, currentValue)
  );
}

console.log(&quot;3. 查找最大值:&quot;, findMax(numbers)); // 输出: 5

// 4. 查找最小值
function findMin(arr) {
  return arr.reduce((accumulator, currentValue) =&gt;
    Math.min(accumulator, currentValue)
  );
}

console.log(&quot;4. 查找最小值:&quot;, findMin(numbers)); // 输出: 1

// 5. 数组扁平化
function flattenArray(arr) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    return accumulator.concat(
      Array.isArray(currentValue) ? flattenArray(currentValue) : currentValue
    );
  }, []);
}

const nestedArray = [1, [2, 3], [4, [5, 6]]];
console.log(&quot;5. 数组扁平化:&quot;, flattenArray(nestedArray)); // 输出: [1, 2, 3, 4, 5, 6]

// 6. 对象属性计数
function countProperties(arr, property) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    if (currentValue.hasOwnProperty(property)) {
      accumulator[currentValue[property]] =
        (accumulator[currentValue[property]] || 0) + 1;
    }
    return accumulator;
  }, {});
}

const users = [
  { name: &quot;Alice&quot;, city: &quot;New York&quot; },
  { name: &quot;Bob&quot;, city: &quot;London&quot; },
  { name: &quot;Charlie&quot;, city: &quot;New York&quot; },
  { name: &quot;David&quot;, city: &quot;Paris&quot; },
  { name: &quot;Eve&quot;, city: &quot;London&quot; },
];

console.log(&quot;6. 对象属性计数:&quot;, countProperties(users, &quot;city&quot;)); // 输出: { &#39;New York&#39;: 2, London: 2, Paris: 1 }

// 7. 分组数据
function groupBy(arr, key) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const groupKey = currentValue[key];
    if (!accumulator[groupKey]) {
      accumulator[groupKey] = [];
    }
    accumulator[groupKey].push(currentValue);
    return accumulator;
  }, {});
}

console.log(&quot;7. 分组数据:&quot;, groupBy(users, &quot;city&quot;));
// 输出:
// {
//   &#39;New York&#39;: [
//     { name: &#39;Alice&#39;, city: &#39;New York&#39; },
//     { name: &#39;Charlie&#39;, city: &#39;New York&#39; }
//   ],
//   London: [
//     { name: &#39;Bob&#39;, city: &#39;London&#39; },
//     { name: &#39;Eve&#39;, city: &#39;London&#39; }
//   ],
//   Paris: [ { name: &#39;David&#39;, city: &#39;Paris&#39; } ]
// }

// 8. 管道操作
function pipe(...fns) {
  return (initialValue) =&gt;
    fns.reduce((accumulator, fn) =&gt; fn(accumulator), initialValue);
}

function add(x) {
  return x + 2;
}

function multiply(x) {
  return x * 3;
}

function subtract(x) {
  return x - 1;
}

const pipeline = pipe(add, multiply, subtract);
console.log(&quot;8. 管道操作:&quot;, pipeline(5)); // 输出: 20 ( (5 + 2) * 3 - 1 )

// 9. 字符串反转
function reverseString(str) {
  return str
    .split(&quot;&quot;)
    .reduce((accumulator, currentValue) =&gt; currentValue + accumulator, &quot;&quot;);
}

console.log(&quot;9. 字符串反转:&quot;, reverseString(&quot;hello&quot;)); // 输出: olleh

// 10. 数组去重
function uniqueArray(arr) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    if (!accumulator.includes(currentValue)) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const duplicateArray = [1, 2, 2, 3, 4, 4, 5];
console.log(&quot;10. 数组去重:&quot;, uniqueArray(duplicateArray)); // 输出: [1, 2, 3, 4, 5]

// 11. 处理异步操作 (Promise 串行执行)
async function asyncOperation(value) {
  return new Promise((resolve) =&gt; {
    setTimeout(() =&gt; {
      resolve(value * 2);
    }, 500);
  });
}

async function processAsyncOperations(arr) {
  return arr.reduce(async (accumulatorPromise, currentValue) =&gt; {
    const accumulator = await accumulatorPromise;
    const result = await asyncOperation(currentValue);
    return accumulator.concat(result);
  }, Promise.resolve([]));
}

async function runAsyncExample() {
  const asyncNumbers = [1, 2, 3];
  const results = await processAsyncOperations(asyncNumbers);
  console.log(&quot;11. 处理异步操作:&quot;, results); // 输出: [2, 4, 6] (大约 1.5 秒后)
}

runAsyncExample();

// 12. 构建复杂的对象
function buildComplexObject(arr) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const [key, value] = currentValue;
    const keys = key.split(&quot;.&quot;);
    let current = accumulator;
    for (let i = 0; i &lt; keys.length - 1; i++) {
      const k = keys[i];
      if (!current[k]) {
        current[k] = {};
      }
      current = current[k];
    }
    current[keys[keys.length - 1]] = value;
    return accumulator;
  }, {});
}

const data = [
  [&quot;a.b.c&quot;, 1],
  [&quot;a.b.d&quot;, 2],
  [&quot;a.e&quot;, 3],
  [&quot;f&quot;, 4],
];

console.log(&quot;12. 构建复杂的对象:&quot;, buildComplexObject(data));
// 输出:
// {
//   a: { b: { c: 1, d: 2 }, e: 3 },
//   f: 4
// }

// 13. 实现函数组合 (更灵活的 pipe)
function compose(...fns) {
  return (initialValue) =&gt;
    fns.reduceRight((accumulator, fn) =&gt; fn(accumulator), initialValue);
}

const composedPipeline = compose(subtract, multiply, add);
console.log(&quot;13. 函数组合:&quot;, composedPipeline(5)); // 输出: 18 ( (5 + 2) * 3 - 1 )

// 14. 数据转换
function transformData(arr) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const { id, name, details } = currentValue;
    const transformedDetails = details.map((detail) =&gt; ({
      ...detail,
      full_name: `${name} - ${detail.description}`,
    }));
    accumulator[id] = {
      name,
      details: transformedDetails,
    };
    return accumulator;
  }, {});
}

const rawData = [
  {
    id: 1,
    name: &quot;Product A&quot;,
    details: [
      { description: &quot;Detail 1&quot;, price: 10 },
      { description: &quot;Detail 2&quot;, price: 20 },
    ],
  },
  {
    id: 2,
    name: &quot;Product B&quot;,
    details: [
      { description: &quot;Detail 3&quot;, price: 30 },
      { description: &quot;Detail 4&quot;, price: 40 },
    ],
  },
];

console.log(&quot;14. 数据转换:&quot;, transformData(rawData));
// 输出:
// {
//   &#39;1&#39;: {
//     name: &#39;Product A&#39;,
//     details: [
//       { description: &#39;Detail 1&#39;, price: 10, full_name: &#39;Product A - Detail 1&#39; },
//       { description: &#39;Detail 2&#39;, price: 20, full_name: &#39;Product A - Detail 2&#39; }
//     ]
//   },
//   &#39;2&#39;: {
//     name: &#39;Product B&#39;,
//     details: [
//       { description: &#39;Detail 3&#39;, price: 30, full_name: &#39;Product B - Detail 3&#39; },
//       { description: &#39;Detail 4&#39;, price: 40, full_name: &#39;Product B - Detail 4&#39; }
//     ]
//   }
// }

// 15. 自定义累加器 (使用对象)
function customAccumulator(arr) {
  return arr.reduce(
    (accumulator, currentValue) =&gt; {
      if (currentValue &gt; 0) {
        accumulator.positive.push(currentValue);
      } else if (currentValue &lt; 0) {
        accumulator.negative.push(currentValue);
      } else {
        accumulator.zero.push(currentValue);
      }
      return accumulator;
    },
    { positive: [], negative: [], zero: [] }
  );
}

const mixedNumbers = [-2, 1, 0, 3, -1, 0, 5];
console.log(&quot;15. 自定义累加器:&quot;, customAccumulator(mixedNumbers));
// 输出:
// { positive: [ 1, 3, 5 ], negative: [ -2, -1 ], zero: [ 0, 0 ] }

// 16. 使用 reduce 实现 map
function customMap(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    accumulator.push(callback(currentValue, index, array));
    return accumulator;
  }, []);
}

const mapNumbers = [1, 2, 3, 4];
const mappedNumbers = customMap(mapNumbers, (num) =&gt; num * 2);
console.log(&quot;16. 使用 reduce 实现 map:&quot;, mappedNumbers); // 输出: [2, 4, 6, 8]

// 17. 使用 reduce 实现 filter
function customFilter(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    if (callback(currentValue, index, array)) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const filterNumbers = [1, 2, 3, 4, 5, 6];
const filteredNumbers = customFilter(filterNumbers, (num) =&gt; num % 2 === 0);
console.log(&quot;17. 使用 reduce 实现 filter:&quot;, filteredNumbers); // 输出: [2, 4, 6]

// 18. 使用 reduce 实现 find
function customFind(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== undefined) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return currentValue;
    }
    return undefined;
  }, undefined);
}

const findNumbers = [1, 2, 3, 4, 5];
const foundNumber = customFind(findNumbers, (num) =&gt; num &gt; 3);
console.log(&quot;18. 使用 reduce 实现 find:&quot;, foundNumber); // 输出: 4

// 19. 使用 reduce 实现 findIndex
function customFindIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== -1) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return index;
    }
    return -1;
  }, -1);
}

const findIndexNumbers = [1, 2, 3, 4, 5];
const foundIndex = customFindIndex(findIndexNumbers, (num) =&gt; num &gt; 3);
console.log(&quot;19. 使用 reduce 实现 findIndex:&quot;, foundIndex); // 输出: 3

// 20. 使用 reduce 实现 every
function customEvery(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return accumulator &amp;&amp; callback(currentValue, index, array);
  }, true);
}

const everyNumbers = [2, 4, 6, 8];
const allEven = customEvery(everyNumbers, (num) =&gt; num % 2 === 0);
console.log(&quot;20. 使用 reduce 实现 every:&quot;, allEven); // 输出: true

const notAllEvenNumbers = [2, 4, 5, 8];
const notAllEven = customEvery(notAllEvenNumbers, (num) =&gt; num % 2 === 0);
console.log(&quot;20. 使用 reduce 实现 every:&quot;, notAllEven); // 输出: false

// 21. 使用 reduce 实现 some
function customSome(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return accumulator || callback(currentValue, index, array);
  }, false);
}

const someNumbers = [1, 3, 5, 8];
const hasEven = customSome(someNumbers, (num) =&gt; num % 2 === 0);
console.log(&quot;21. 使用 reduce 实现 some:&quot;, hasEven); // 输出: true

const noEvenNumbers = [1, 3, 5, 7];
const noEven = customSome(noEvenNumbers, (num) =&gt; num % 2 === 0);
console.log(&quot;21. 使用 reduce 实现 some:&quot;, noEven); // 输出: false

// 22. 使用 reduce 实现 flatMap
function customFlatMap(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return accumulator.concat(callback(currentValue, index, array));
  }, []);
}

const flatMapNumbers = [1, 2, 3];
const flatMappedNumbers = customFlatMap(flatMapNumbers, (num) =&gt; [
  num,
  num * 2,
]);
console.log(&quot;22. 使用 reduce 实现 flatMap:&quot;, flatMappedNumbers); // 输出: [1, 2, 2, 4, 3, 6]

// 23. 使用 reduce 实现 reduceRight
function customReduceRight(arr, callback, initialValue) {
  const reversedArr = [...arr].reverse();
  return reversedArr.reduce(callback, initialValue);
}

const reduceRightNumbers = [1, 2, 3, 4];
const reducedRightResult = customReduceRight(
  reduceRightNumbers,
  (acc, curr) =&gt; acc - curr,
  10
);
console.log(&quot;23. 使用 reduce 实现 reduceRight:&quot;, reducedRightResult); // 输出: 0 (10 - 4 - 3 - 2 - 1)

// 24. 使用 reduce 实现 groupBy with custom key function
function customGroupBy(arr, keyFunction) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const key = keyFunction(currentValue);
    if (!accumulator[key]) {
      accumulator[key] = [];
    }
    accumulator[key].push(currentValue);
    return accumulator;
  }, {});
}

const customGroupUsers = [
  { name: &quot;Alice&quot;, age: 25 },
  { name: &quot;Bob&quot;, age: 30 },
  { name: &quot;Charlie&quot;, age: 25 },
  { name: &quot;David&quot;, age: 35 },
];

const groupedByAge = customGroupBy(customGroupUsers, (user) =&gt; user.age);
console.log(
  &quot;24. 使用 reduce 实现 groupBy with custom key function:&quot;,
  groupedByAge
);
// 输出:
// {
//   &#39;25&#39;: [ { name: &#39;Alice&#39;, age: 25 }, { name: &#39;Charlie&#39;, age: 25 } ],
//   &#39;30&#39;: [ { name: &#39;Bob&#39;, age: 30 } ],
//   &#39;35&#39;: [ { name: &#39;David&#39;, age: 35 } ]
// }

// 25. 使用 reduce 实现 partition
function customPartition(arr, callback) {
  return arr.reduce(
    (accumulator, currentValue, index, array) =&gt; {
      if (callback(currentValue, index, array)) {
        accumulator[0].push(currentValue);
      } else {
        accumulator[1].push(currentValue);
      }
      return accumulator;
    },
    [[], []]
  );
}

const partitionNumbers = [1, 2, 3, 4, 5, 6];
const [evenNumbers, oddNumbers] = customPartition(
  partitionNumbers,
  (num) =&gt; num % 2 === 0
);
console.log(&quot;25. 使用 reduce 实现 partition:&quot;, evenNumbers, oddNumbers); // 输出: [2, 4, 6] [1, 3, 5]

// 26. 使用 reduce 实现 chunk
function customChunk(arr, size) {
  return arr.reduce((accumulator, currentValue, index) =&gt; {
    const chunkIndex = Math.floor(index / size);
    if (!accumulator[chunkIndex]) {
      accumulator[chunkIndex] = [];
    }
    accumulator[chunkIndex].push(currentValue);
    return accumulator;
  }, []);
}

const chunkNumbers = [1, 2, 3, 4, 5, 6, 7, 8];
const chunkedNumbers = customChunk(chunkNumbers, 3);
console.log(&quot;26. 使用 reduce 实现 chunk:&quot;, chunkedNumbers); // 输出: [[1, 2, 3], [4, 5, 6], [7, 8]]

// 27. 使用 reduce 实现 zip
function customZip(...arrays) {
  return arrays[0].reduce((accumulator, _, index) =&gt; {
    const zipped = arrays.map((arr) =&gt; arr[index]);
    accumulator.push(zipped);
    return accumulator;
  }, []);
}

const zipArrays1 = [1, 2, 3];
const zipArrays2 = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];
const zipArrays3 = [true, false, true];
const zippedArrays = customZip(zipArrays1, zipArrays2, zipArrays3);
console.log(&quot;27. 使用 reduce 实现 zip:&quot;, zippedArrays); // 输出: [[1, &#39;a&#39;, true], [2, &#39;b&#39;, false], [3, &#39;c&#39;, true]]

// 28. 使用 reduce 实现 unzip
function customUnzip(arr) {
  if (!arr || arr.length === 0) {
    return [];
  }
  const numArrays = arr[0].length;
  return arr.reduce(
    (accumulator, current) =&gt; {
      current.forEach((value, index) =&gt; {
        if (!accumulator[index]) {
          accumulator[index] = [];
        }
        accumulator[index].push(value);
      });
      return accumulator;
    },
    Array.from({ length: numArrays }, () =&gt; [])
  );
}

const unzipArrays = [
  [1, &quot;a&quot;, true],
  [2, &quot;b&quot;, false],
  [3, &quot;c&quot;, true],
];
const unzippedArrays = customUnzip(unzipArrays);
console.log(&quot;28. 使用 reduce 实现 unzip:&quot;, unzippedArrays); // 输出: [[1, 2, 3], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [true, false, true]]

// 29. 使用 reduce 实现 countBy
function customCountBy(arr, keyFunction) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const key = keyFunction(currentValue);
    accumulator[key] = (accumulator[key] || 0) + 1;
    return accumulator;
  }, {});
}

const countByUsers = [
  { name: &quot;Alice&quot;, age: 25 },
  { name: &quot;Bob&quot;, age: 30 },
  { name: &quot;Charlie&quot;, age: 25 },
  { name: &quot;David&quot;, age: 35 },
];

const countedByAge = customCountBy(countByUsers, (user) =&gt; user.age);
console.log(&quot;29. 使用 reduce 实现 countBy:&quot;, countedByAge); // 输出: { &#39;25&#39;: 2, &#39;30&#39;: 1, &#39;35&#39;: 1 }

// 30. 使用 reduce 实现 sumBy
function customSumBy(arr, keyFunction) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const value = keyFunction(currentValue);
    return accumulator + value;
  }, 0);
}

const sumByUsers = [
  { name: &quot;Alice&quot;, age: 25 },
  { name: &quot;Bob&quot;, age: 30 },
  { name: &quot;Charlie&quot;, age: 25 },
  { name: &quot;David&quot;, age: 35 },
];

const sumOfAges = customSumBy(sumByUsers, (user) =&gt; user.age);
console.log(&quot;30. 使用 reduce 实现 sumBy:&quot;, sumOfAges); // 输出: 115

// 31. 使用 reduce 实现 minBy
function customMinBy(arr, keyFunction) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const currentKey = keyFunction(currentValue);
    if (accumulator === undefined || currentKey &lt; keyFunction(accumulator)) {
      return currentValue;
    }
    return accumulator;
  }, undefined);
}

const minByUsers = [
  { name: &quot;Alice&quot;, age: 25 },
  { name: &quot;Bob&quot;, age: 30 },
  { name: &quot;Charlie&quot;, age: 20 },
  { name: &quot;David&quot;, age: 35 },
];

const minAgeUser = customMinBy(minByUsers, (user) =&gt; user.age);
console.log(&quot;31. 使用 reduce 实现 minBy:&quot;, minAgeUser); // 输出: { name: &#39;Charlie&#39;, age: 20 }

// 32. 使用 reduce 实现 maxBy
function customMaxBy(arr, keyFunction) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const currentKey = keyFunction(currentValue);
    if (accumulator === undefined || currentKey &gt; keyFunction(accumulator)) {
      return currentValue;
    }
    return accumulator;
  }, undefined);
}

const maxByUsers = [
  { name: &quot;Alice&quot;, age: 25 },
  { name: &quot;Bob&quot;, age: 30 },
  { name: &quot;Charlie&quot;, age: 20 },
  { name: &quot;David&quot;, age: 35 },
];

const maxAgeUser = customMaxBy(maxByUsers, (user) =&gt; user.age);
console.log(&quot;32. 使用 reduce 实现 maxBy:&quot;, maxAgeUser); // 输出: { name: &#39;David&#39;, age: 35 }

// 33. 使用 reduce 实现 keyBy
function customKeyBy(arr, keyFunction) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    const key = keyFunction(currentValue);
    accumulator[key] = currentValue;
    return accumulator;
  }, {});
}

const keyByUsers = [
  { id: 1, name: &quot;Alice&quot; },
  { id: 2, name: &quot;Bob&quot; },
  { id: 3, name: &quot;Charlie&quot; },
];

const keyedById = customKeyBy(keyByUsers, (user) =&gt; user.id);
console.log(&quot;33. 使用 reduce 实现 keyBy:&quot;, keyedById);
// 输出:
// {
//   &#39;1&#39;: { id: 1, name: &#39;Alice&#39; },
//   &#39;2&#39;: { id: 2, name: &#39;Bob&#39; },
//   &#39;3&#39;: { id: 3, name: &#39;Charlie&#39; }
// }

// 34. 使用 reduce 实现 flat
function customFlat(arr, depth = 1) {
  return arr.reduce((accumulator, currentValue) =&gt; {
    if (Array.isArray(currentValue) &amp;&amp; depth &gt; 0) {
      return accumulator.concat(customFlat(currentValue, depth - 1));
    }
    return accumulator.concat(currentValue);
  }, []);
}

const flatArray = [1, [2, [3, [4]], 5], 6];
const flattenedArray = customFlat(flatArray, 2);
console.log(&quot;34. 使用 reduce 实现 flat:&quot;, flattenedArray); // 输出: [1, 2, 3, [4], 5, 6]

const deeplyFlattenedArray = customFlat(flatArray, Infinity);
console.log(&quot;34. 使用 reduce 实现 flat (deep):&quot;, deeplyFlattenedArray); // 输出: [1, 2, 3, 4, 5, 6]

// 35. 使用 reduce 实现 intersection
function customIntersection(arr1, arr2) {
  return arr1.reduce((accumulator, currentValue) =&gt; {
    if (arr2.includes(currentValue)) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const intersectionArray1 = [1, 2, 3, 4, 5];
const intersectionArray2 = [3, 4, 5, 6, 7];
const intersectionResult = customIntersection(
  intersectionArray1,
  intersectionArray2
);
console.log(&quot;35. 使用 reduce 实现 intersection:&quot;, intersectionResult); // 输出: [3, 4, 5]

// 36. 使用 reduce 实现 difference
function customDifference(arr1, arr2) {
  return arr1.reduce((accumulator, currentValue) =&gt; {
    if (!arr2.includes(currentValue)) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const differenceArray1 = [1, 2, 3, 4, 5];
const differenceArray2 = [3, 4, 5, 6, 7];
const differenceResult = customDifference(differenceArray1, differenceArray2);
console.log(&quot;36. 使用 reduce 实现 difference:&quot;, differenceResult); // 输出: [1, 2]

// 37. 使用 reduce 实现 union
function customUnion(arr1, arr2) {
  return arr1.concat(arr2).reduce((accumulator, currentValue) =&gt; {
    if (!accumulator.includes(currentValue)) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const unionArray1 = [1, 2, 3];
const unionArray2 = [3, 4, 5];
const unionResult = customUnion(unionArray1, unionArray2);
console.log(&quot;37. 使用 reduce 实现 union:&quot;, unionResult); // 输出: [1, 2, 3, 4, 5]

// 38. 使用 reduce 实现 symmetricDifference
function customSymmetricDifference(arr1, arr2) {
  const diff1 = customDifference(arr1, arr2);
  const diff2 = customDifference(arr2, arr1);
  return customUnion(diff1, diff2);
}

const symmetricDifferenceArray1 = [1, 2, 3, 4];
const symmetricDifferenceArray2 = [3, 4, 5, 6];
const symmetricDifferenceResult = customSymmetricDifference(
  symmetricDifferenceArray1,
  symmetricDifferenceArray2
);
console.log(
  &quot;38. 使用 reduce 实现 symmetricDifference:&quot;,
  symmetricDifferenceResult
); // 输出: [1, 2, 5, 6]

// 39. 使用 reduce 实现 shuffle
function customShuffle(arr) {
  return arr.reduce(
    (accumulator, _, index) =&gt; {
      const randomIndex = Math.floor(Math.random() * (index + 1));
      [accumulator[index], accumulator[randomIndex]] = [
        accumulator[randomIndex],
        accumulator[index],
      ];
      return accumulator;
    },
    [...arr]
  );
}

const shuffleArray = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
const shuffledArray = customShuffle(shuffleArray);
console.log(&quot;39. 使用 reduce 实现 shuffle:&quot;, shuffledArray); // 输出: 随机排序的数组

// 40. 使用 reduce 实现 range
function customRange(start, end, step = 1) {
  const length = Math.max(Math.ceil((end - start) / step), 0);
  return Array.from({ length }, (_, index) =&gt; start + index * step);
}

const rangeArray = customRange(1, 10, 2);
console.log(&quot;40. 使用 reduce 实现 range:&quot;, rangeArray); // 输出: [1, 3, 5, 7, 9]

const rangeArray2 = customRange(10, 1, -2);
console.log(&quot;40. 使用 reduce 实现 range (reverse):&quot;, rangeArray2); // 输出: [10, 8, 6, 4, 2]

// 41. 使用 reduce 实现 fill
function customFill(arr, value, start = 0, end = arr.length) {
  return arr.reduce(
    (accumulator, currentValue, index) =&gt; {
      if (index &gt;= start &amp;&amp; index &lt; end) {
        accumulator[index] = value;
      }
      return accumulator;
    },
    [...arr]
  );
}

const fillArray = [1, 2, 3, 4, 5];
const filledArray = customFill(fillArray, 0, 1, 4);
console.log(&quot;41. 使用 reduce 实现 fill:&quot;, filledArray); // 输出: [1, 0, 0, 0, 5]

// 42. 使用 reduce 实现 padStart
function customPadStart(str, targetLength, padString = &quot; &quot;) {
  if (str.length &gt;= targetLength) {
    return str;
  }
  const paddingLength = targetLength - str.length;
  const padding = Array.from({ length: paddingLength }, () =&gt; padString).join(
    &quot;&quot;
  );
  return padding + str;
}

const padStartString = &quot;123&quot;;
const paddedStartString = customPadStart(padStartString, 5, &quot;0&quot;);
console.log(&quot;42. 使用 reduce 实现 padStart:&quot;, paddedStartString); // 输出: &quot;00123&quot;

// 43. 使用 reduce 实现 padEnd
function customPadEnd(str, targetLength, padString = &quot; &quot;) {
  if (str.length &gt;= targetLength) {
    return str;
  }
  const paddingLength = targetLength - str.length;
  const padding = Array.from({ length: paddingLength }, () =&gt; padString).join(
    &quot;&quot;
  );
  return str + padding;
}

const padEndString = &quot;123&quot;;
const paddedEndString = customPadEnd(padEndString, 5, &quot;0&quot;);
console.log(&quot;43. 使用 reduce 实现 padEnd:&quot;, paddedEndString); // 输出: &quot;12300&quot;

// 44. 使用 reduce 实现 repeat
function customRepeat(str, count) {
  return Array.from({ length: count }, () =&gt; str).join(&quot;&quot;);
}

const repeatString = &quot;abc&quot;;
const repeatedString = customRepeat(repeatString, 3);
console.log(&quot;44. 使用 reduce 实现 repeat:&quot;, repeatedString); // 输出: &quot;abcabcabc&quot;

// 45. 使用 reduce 实现 trim
function customTrim(str) {
  return str
    .reduce((accumulator, currentValue) =&gt; {
      if (currentValue !== &quot; &quot;) {
        accumulator.push(currentValue);
      }
      return accumulator;
    }, [])
    .join(&quot;&quot;);
}

const trimString = &quot;   hello world   &quot;;
const trimmedString = customTrim(trimString.split(&quot;&quot;));
console.log(&quot;45. 使用 reduce 实现 trim:&quot;, trimmedString); // 输出: &quot;helloworld&quot;

// 46. 使用 reduce 实现 trimStart
function customTrimStart(str) {
  let trimmed = false;
  return str
    .reduce((accumulator, currentValue) =&gt; {
      if (!trimmed &amp;&amp; currentValue === &quot; &quot;) {
        return accumulator;
      }
      trimmed = true;
      accumulator.push(currentValue);
      return accumulator;
    }, [])
    .join(&quot;&quot;);
}

const trimStartString = &quot;   hello world   &quot;;
const trimmedStartString = customTrimStart(trimStartString.split(&quot;&quot;));
console.log(&quot;46. 使用 reduce 实现 trimStart:&quot;, trimmedStartString); // 输出: &quot;hello world   &quot;

// 47. 使用 reduce 实现 trimEnd
function customTrimEnd(str) {
  let trimmed = false;
  return str
    .reduceRight((accumulator, currentValue) =&gt; {
      if (!trimmed &amp;&amp; currentValue === &quot; &quot;) {
        return accumulator;
      }
      trimmed = true;
      accumulator.unshift(currentValue);
      return accumulator;
    }, [])
    .join(&quot;&quot;);
}

const trimEndString = &quot;   hello world   &quot;;
const trimmedEndString = customTrimEnd(trimEndString.split(&quot;&quot;));
console.log(&quot;47. 使用 reduce 实现 trimEnd:&quot;, trimmedEndString); // 输出: &quot;   hello world&quot;

// 48. 使用 reduce 实现 startsWith
function customStartsWith(str, searchString, position = 0) {
  return str
    .slice(position, position + searchString.length)
    .reduce((accumulator, currentValue, index) =&gt; {
      return accumulator &amp;&amp; currentValue === searchString[index];
    }, true);
}

const startsWithString = &quot;hello world&quot;;
const startsWithResult = customStartsWith(startsWithString.split(&quot;&quot;), &quot;hello&quot;);
console.log(&quot;48. 使用 reduce 实现 startsWith:&quot;, startsWithResult); // 输出: true

const startsWithResult2 = customStartsWith(startsWithString.split(&quot;&quot;), &quot;world&quot;);
console.log(&quot;48. 使用 reduce 实现 startsWith (false):&quot;, startsWithResult2); // 输出: false

// 49. 使用 reduce 实现 endsWith
function customEndsWith(str, searchString, position = str.length) {
  const start = Math.max(0, position - searchString.length);
  return str
    .slice(start, position)
    .reduce((accumulator, currentValue, index) =&gt; {
      return accumulator &amp;&amp; currentValue === searchString[index];
    }, true);
}

const endsWithString = &quot;hello world&quot;;
const endsWithResult = customEndsWith(endsWithString.split(&quot;&quot;), &quot;world&quot;);
console.log(&quot;49. 使用 reduce 实现 endsWith:&quot;, endsWithResult); // 输出: true

const endsWithResult2 = customEndsWith(endsWithString.split(&quot;&quot;), &quot;hello&quot;);
console.log(&quot;49. 使用 reduce 实现 endsWith (false):&quot;, endsWithResult2); // 输出: false

// 50. 使用 reduce 实现 includes
function customIncludes(arr, searchElement, fromIndex = 0) {
  return arr.slice(fromIndex).reduce((accumulator, currentValue) =&gt; {
    return accumulator || currentValue === searchElement;
  }, false);
}

const includesArray = [1, 2, 3, 4, 5];
const includesResult = customIncludes(includesArray, 3);
console.log(&quot;50. 使用 reduce 实现 includes:&quot;, includesResult); // 输出: true

const includesResult2 = customIncludes(includesArray, 6);
console.log(&quot;50. 使用 reduce 实现 includes (false):&quot;, includesResult2); // 输出: false

// 51. 使用 reduce 实现 indexOf
function customIndexOf(arr, searchElement, fromIndex = 0) {
  return arr.slice(fromIndex).reduce((accumulator, currentValue, index) =&gt; {
    if (accumulator !== -1) {
      return accumulator;
    }
    if (currentValue === searchElement) {
      return index + fromIndex;
    }
    return -1;
  }, -1);
}

const indexOfArray = [1, 2, 3, 4, 5, 3];
const indexOfResult = customIndexOf(indexOfArray, 3);
console.log(&quot;51. 使用 reduce 实现 indexOf:&quot;, indexOfResult); // 输出: 2

const indexOfResult2 = customIndexOf(indexOfArray, 6);
console.log(&quot;51. 使用 reduce 实现 indexOf (not found):&quot;, indexOfResult2); // 输出: -1

// 52. 使用 reduce 实现 lastIndexOf
function customLastIndexOf(arr, searchElement, fromIndex = arr.length - 1) {
  return arr
    .slice(0, fromIndex + 1)
    .reduceRight((accumulator, currentValue, index) =&gt; {
      if (accumulator !== -1) {
        return accumulator;
      }
      if (currentValue === searchElement) {
        return index;
      }
      return -1;
    }, -1);
}

const lastIndexOfArray = [1, 2, 3, 4, 5, 3];
const lastIndexOfResult = customLastIndexOf(lastIndexOfArray, 3);
console.log(&quot;52. 使用 reduce 实现 lastIndexOf:&quot;, lastIndexOfResult); // 输出: 5

const lastIndexOfResult2 = customLastIndexOf(lastIndexOfArray, 6);
console.log(
  &quot;52. 使用 reduce 实现 lastIndexOf (not found):&quot;,
  lastIndexOfResult2
); // 输出: -1

// 53. 使用 reduce 实现 join
function customJoin(arr, separator = &quot;,&quot;) {
  return arr.reduce((accumulator, currentValue, index) =&gt; {
    if (index === 0) {
      return String(currentValue);
    }
    return accumulator + separator + String(currentValue);
  }, &quot;&quot;);
}

const joinArray = [1, 2, 3, 4, 5];
const joinedString = customJoin(joinArray, &quot;-&quot;);
console.log(&quot;53. 使用 reduce 实现 join:&quot;, joinedString); // 输出: &quot;1-2-3-4-5&quot;

const joinedString2 = customJoin(joinArray);
console.log(&quot;53. 使用 reduce 实现 join (default separator):&quot;, joinedString2); // 输出: &quot;1,2,3,4,5&quot;

// 54. 使用 reduce 实现 reverse
function customReverse(arr) {
  return arr.reduceRight((accumulator, currentValue) =&gt; {
    accumulator.push(currentValue);
    return accumulator;
  }, []);
}

const reverseArray = [1, 2, 3, 4, 5];
const reversedArray = customReverse(reverseArray);
console.log(&quot;54. 使用 reduce 实现 reverse:&quot;, reversedArray); // 输出: [5, 4, 3, 2, 1]

// 55. 使用 reduce 实现 slice
function customSlice(arr, start = 0, end = arr.length) {
  return arr.reduce((accumulator, currentValue, index) =&gt; {
    if (index &gt;= start &amp;&amp; index &lt; end) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const sliceArray = [1, 2, 3, 4, 5];
const slicedArray = customSlice(sliceArray, 1, 4);
console.log(&quot;55. 使用 reduce 实现 slice:&quot;, slicedArray); // 输出: [2, 3, 4]

const slicedArray2 = customSlice(sliceArray, 2);
console.log(&quot;55. 使用 reduce 实现 slice (from start):&quot;, slicedArray2); // 输出: [3, 4, 5]

// 56. 使用 reduce 实现 splice
function customSplice(arr, start, deleteCount, ...items) {
  const deleted = [];
  const result = arr.reduce((accumulator, currentValue, index) =&gt; {
    if (index &lt; start || index &gt;= start + deleteCount) {
      accumulator.push(currentValue);
    } else {
      deleted.push(currentValue);
    }
    return accumulator;
  }, []);
  result.splice(start, 0, ...items);
  return { result, deleted };
}

const spliceArray = [1, 2, 3, 4, 5];
const { result: splicedResult, deleted: splicedDeleted } = customSplice(
  spliceArray,
  1,
  2,
  6,
  7
);
console.log(&quot;56. 使用 reduce 实现 splice:&quot;, splicedResult, splicedDeleted); // 输出: [1, 6, 7, 4, 5] [2, 3]

const spliceArray2 = [1, 2, 3, 4, 5];
const { result: splicedResult2, deleted: splicedDeleted2 } = customSplice(
  spliceArray2,
  2,
  0,
  6,
  7
);
console.log(
  &quot;56. 使用 reduce 实现 splice (insert):&quot;,
  splicedResult2,
  splicedDeleted2
); // 输出: [1, 2, 6, 7, 3, 4, 5] []

// 57. 使用 reduce 实现 toReversed
function customToReversed(arr) {
  return arr.reduceRight((accumulator, currentValue) =&gt; {
    accumulator.push(currentValue);
    return accumulator;
  }, []);
}

const toReversedArray = [1, 2, 3, 4, 5];
const reversedArray2 = customToReversed(toReversedArray);
console.log(&quot;57. 使用 reduce 实现 toReversed:&quot;, reversedArray2); // 输出: [5, 4, 3, 2, 1]

// 58. 使用 reduce 实现 toSorted
function customToSorted(arr, compareFn) {
  return [...arr].reduce((accumulator, currentValue) =&gt; {
    let i = 0;
    while (
      i &lt; accumulator.length &amp;&amp;
      (compareFn
        ? compareFn(currentValue, accumulator[i]) &gt; 0
        : String(currentValue) &gt; String(accumulator[i]))
    ) {
      i++;
    }
    accumulator.splice(i, 0, currentValue);
    return accumulator;
  }, []);
}

const toSortedArray = [3, 1, 4, 2, 5];
const sortedArray = customToSorted(toSortedArray);
console.log(&quot;58. 使用 reduce 实现 toSorted:&quot;, sortedArray); // 输出: [1, 2, 3, 4, 5]

const toSortedArray2 = [3, 1, 4, 2, 5];
const sortedArray2 = customToSorted(toSortedArray2, (a, b) =&gt; b - a);
console.log(&quot;58. 使用 reduce 实现 toSorted (descending):&quot;, sortedArray2); // 输出: [5, 4, 3, 2, 1]

// 59. 使用 reduce 实现 toSpliced
function customToSpliced(arr, start, deleteCount, ...items) {
  const result = [...arr].reduce((accumulator, currentValue, index) =&gt; {
    if (index &lt; start || index &gt;= start + deleteCount) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
  result.splice(start, 0, ...items);
  return result;
}

const toSplicedArray = [1, 2, 3, 4, 5];
const splicedArray3 = customToSpliced(toSplicedArray, 1, 2, 6, 7);
console.log(&quot;59. 使用 reduce 实现 toSpliced:&quot;, splicedArray3); // 输出: [1, 6, 7, 4, 5]

const toSplicedArray2 = [1, 2, 3, 4, 5];
const splicedArray4 = customToSpliced(toSplicedArray2, 2, 0, 6, 7);
console.log(&quot;59. 使用 reduce 实现 toSpliced (insert):&quot;, splicedArray4); // 输出: [1, 2, 6, 7, 3, 4, 5]

// 60. 使用 reduce 实现 with
function customWith(arr, index, value) {
  return arr.reduce((accumulator, currentValue, currentIndex) =&gt; {
    if (currentIndex === index) {
      accumulator.push(value);
    } else {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const withArray = [1, 2, 3, 4, 5];
const withResult = customWith(withArray, 2, 6);
console.log(&quot;60. 使用 reduce 实现 with:&quot;, withResult); // 输出: [1, 2, 6, 4, 5]

// 61. 使用 reduce 实现 findLast
function customFindLast(arr, callback) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== undefined) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return currentValue;
    }
    return undefined;
  }, undefined);
}

const findLastArray = [1, 2, 3, 4, 5, 3];
const findLastResult = customFindLast(findLastArray, (num) =&gt; num === 3);
console.log(&quot;61. 使用 reduce 实现 findLast:&quot;, findLastResult); // 输出: 3

const findLastResult2 = customFindLast(findLastArray, (num) =&gt; num &gt; 5);
console.log(&quot;61. 使用 reduce 实现 findLast (not found):&quot;, findLastResult2); // 输出: undefined

// 62. 使用 reduce 实现 findLastIndex
function customFindLastIndex(arr, callback) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== -1) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return index;
    }
    return -1;
  }, -1);
}

const findLastIndexArray = [1, 2, 3, 4, 5, 3];
const findLastIndexResult = customFindLastIndex(
  findLastIndexArray,
  (num) =&gt; num === 3
);
console.log(&quot;62. 使用 reduce 实现 findLastIndex:&quot;, findLastIndexResult); // 输出: 5

const findLastIndexResult2 = customFindLastIndex(
  findLastIndexArray,
  (num) =&gt; num &gt; 5
);
console.log(
  &quot;62. 使用 reduce 实现 findLastIndex (not found):&quot;,
  findLastIndexResult2
); // 输出: -1

// 63. 使用 reduce 实现 flatMap with depth
function customFlatMapWithDepth(arr, callback, depth = 1) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    const mappedValue = callback(currentValue, index, array);
    if (Array.isArray(mappedValue) &amp;&amp; depth &gt; 0) {
      return accumulator.concat(
        customFlatMapWithDepth(mappedValue, (x) =&gt; x, depth - 1)
      );
    }
    return accumulator.concat(mappedValue);
  }, []);
}

const flatMapWithDepthArray = [1, 2, 3];
const flatMapWithDepthResult = customFlatMapWithDepth(
  flatMapWithDepthArray,
  (num) =&gt; [num, [num * 2]],
  2
);
console.log(&quot;63. 使用 reduce 实现 flatMap with depth:&quot;, flatMapWithDepthResult); // 输出: [1, [2], 2, [4], 3, [6]]

const flatMapWithDepthResult2 = customFlatMapWithDepth(
  flatMapWithDepthArray,
  (num) =&gt; [num, [num * 2]],
  1
);
console.log(
  &quot;63. 使用 reduce 实现 flatMap with depth (depth 1):&quot;,
  flatMapWithDepthResult2
); // 输出: [1, [2], 2, [4], 3, [6]]

// 64. 使用 reduce 实现 reduce with index
function customReduceWithIndex(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithIndexArray = [1, 2, 3, 4, 5];
const reduceWithIndexResult = customReduceWithIndex(
  reduceWithIndexArray,
  (acc, curr, index) =&gt; acc + curr + index,
  0
);
console.log(&quot;64. 使用 reduce 实现 reduce with index:&quot;, reduceWithIndexResult); // 输出: 20 (1+0 + 2+1 + 3+2 + 4+3 + 5+4)

// 65. 使用 reduce 实现 reduceRight with index
function customReduceRightWithIndex(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithIndexArray = [1, 2, 3, 4, 5];
const reduceRightWithIndexResult = customReduceRightWithIndex(
  reduceRightWithIndexArray,
  (acc, curr, index) =&gt; acc + curr + index,
  0
);
console.log(
  &quot;65. 使用 reduce 实现 reduceRight with index:&quot;,
  reduceRightWithIndexResult
); // 输出: 20 (5+4 + 4+3 + 3+2 + 2+1 + 1+0)

// 66. 使用 reduce 实现 forEach
function customForEach(arr, callback) {
  arr.reduce((_, currentValue, index, array) =&gt; {
    callback(currentValue, index, array);
    return undefined;
  }, undefined);
}

const forEachArray = [1, 2, 3];
customForEach(forEachArray, (num, index) =&gt;
  console.log(`forEach: index ${index}, value ${num}`)
);
// 输出:
// forEach: index 0, value 1
// forEach: index 1, value 2
// forEach: index 2, value 3

// 67. 使用 reduce 实现 some with index
function customSomeWithIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return accumulator || callback(currentValue, index, array);
  }, false);
}

const someWithIndexArray = [1, 3, 5, 8];
const hasEvenWithIndex = customSomeWithIndex(
  someWithIndexArray,
  (num, index) =&gt; num % 2 === 0 &amp;&amp; index &gt; 0
);
console.log(&quot;67. 使用 reduce 实现 some with index:&quot;, hasEvenWithIndex); // 输出: true

const noEvenWithIndexArray = [1, 3, 5, 7];
const noEvenWithIndex = customSomeWithIndex(
  noEvenWithIndexArray,
  (num, index) =&gt; num % 2 === 0 &amp;&amp; index &gt; 0
);
console.log(&quot;67. 使用 reduce 实现 some with index (false):&quot;, noEvenWithIndex); // 输出: false

// 68. 使用 reduce 实现 every with index
function customEveryWithIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return accumulator &amp;&amp; callback(currentValue, index, array);
  }, true);
}

const everyWithIndexArray = [2, 4, 6, 8];
const allEvenWithIndex = customEveryWithIndex(
  everyWithIndexArray,
  (num, index) =&gt; num % 2 === 0 &amp;&amp; index &gt; 0
);
console.log(&quot;68. 使用 reduce 实现 every with index:&quot;, allEvenWithIndex); // 输出: true

const notAllEvenWithIndexArray = [2, 4, 5, 8];
const notAllEvenWithIndex = customEveryWithIndex(
  notAllEvenWithIndexArray,
  (num, index) =&gt; num % 2 === 0 &amp;&amp; index &gt; 0
);
console.log(
  &quot;68. 使用 reduce 实现 every with index (false):&quot;,
  notAllEvenWithIndex
); // 输出: false

// 69. 使用 reduce 实现 map with index
function customMapWithIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    accumulator.push(callback(currentValue, index, array));
    return accumulator;
  }, []);
}

const mapWithIndexArray = [1, 2, 3, 4];
const mappedWithIndex = customMapWithIndex(
  mapWithIndexArray,
  (num, index) =&gt; num * 2 + index
);
console.log(&quot;69. 使用 reduce 实现 map with index:&quot;, mappedWithIndex); // 输出: [2, 5, 8, 11]

// 70. 使用 reduce 实现 filter with index
function customFilterWithIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    if (callback(currentValue, index, array)) {
      accumulator.push(currentValue);
    }
    return accumulator;
  }, []);
}

const filterWithIndexArray = [1, 2, 3, 4, 5, 6];
const filteredWithIndex = customFilterWithIndex(
  filterWithIndexArray,
  (num, index) =&gt; num % 2 === 0 &amp;&amp; index &gt; 0
);
console.log(&quot;70. 使用 reduce 实现 filter with index:&quot;, filteredWithIndex); // 输出: [2, 4, 6]

// 71. 使用 reduce 实现 find with index
function customFindWithIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== undefined) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return currentValue;
    }
    return undefined;
  }, undefined);
}

const findWithIndexArray = [1, 2, 3, 4, 5];
const foundWithIndex = customFindWithIndex(
  findWithIndexArray,
  (num, index) =&gt; num &gt; 3 &amp;&amp; index &gt; 0
);
console.log(&quot;71. 使用 reduce 实现 find with index:&quot;, foundWithIndex); // 输出: 4

const findWithIndexResult2 = customFindWithIndex(
  findWithIndexArray,
  (num, index) =&gt; num &gt; 5 &amp;&amp; index &gt; 0
);
console.log(
  &quot;71. 使用 reduce 实现 find with index (not found):&quot;,
  findWithIndexResult2
); // 输出: undefined

// 72. 使用 reduce 实现 findIndex with index
function customFindIndexWithIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== -1) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return index;
    }
    return -1;
  }, -1);
}

const findIndexWithIndexArray = [1, 2, 3, 4, 5];
const foundIndexWithIndex = customFindIndexWithIndex(
  findIndexWithIndexArray,
  (num, index) =&gt; num &gt; 3 &amp;&amp; index &gt; 0
);
console.log(&quot;72. 使用 reduce 实现 findIndex with index:&quot;, foundIndexWithIndex); // 输出: 3

const findIndexWithIndexResult2 = customFindIndexWithIndex(
  findIndexWithIndexArray,
  (num, index) =&gt; num &gt; 5 &amp;&amp; index &gt; 0
);
console.log(
  &quot;72. 使用 reduce 实现 findIndex with index (not found):&quot;,
  findIndexWithIndexResult2
); // 输出: -1

// 73. 使用 reduce 实现 findLast with index
function customFindLastWithIndex(arr, callback) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== undefined) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return currentValue;
    }
    return undefined;
  }, undefined);
}

const findLastWithIndexArray = [1, 2, 3, 4, 5, 3];
const findLastWithIndexResult = customFindLastWithIndex(
  findLastWithIndexArray,
  (num, index) =&gt; num === 3 &amp;&amp; index &lt; 5
);
console.log(
  &quot;73. 使用 reduce 实现 findLast with index:&quot;,
  findLastWithIndexResult
); // 输出: 3

const findLastWithIndexResult2 = customFindLastWithIndex(
  findLastWithIndexArray,
  (num, index) =&gt; num &gt; 5 &amp;&amp; index &lt; 5
);
console.log(
  &quot;73. 使用 reduce 实现 findLast with index (not found):&quot;,
  findLastWithIndexResult2
); // 输出: undefined

// 74. 使用 reduce 实现 findLastIndex with index
function customFindLastIndexWithIndex(arr, callback) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    if (accumulator !== -1) {
      return accumulator;
    }
    if (callback(currentValue, index, array)) {
      return index;
    }
    return -1;
  }, -1);
}

const findLastIndexWithIndexArray = [1, 2, 3, 4, 5, 3];
const findLastIndexWithIndexResult = customFindLastIndexWithIndex(
  findLastIndexWithIndexArray,
  (num, index) =&gt; num === 3 &amp;&amp; index &lt; 5
);
console.log(
  &quot;74. 使用 reduce 实现 findLastIndex with index:&quot;,
  findLastIndexWithIndexResult
); // 输出: 2

const findLastIndexWithIndexResult2 = customFindLastIndexWithIndex(
  findLastIndexWithIndexArray,
  (num, index) =&gt; num &gt; 5 &amp;&amp; index &lt; 5
);
console.log(
  &quot;74. 使用 reduce 实现 findLastIndex with index (not found):&quot;,
  findLastIndexWithIndexResult2
); // 输出: -1

// 75. 使用 reduce 实现 flatMap with index
function customFlatMapWithIndex(arr, callback) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return accumulator.concat(callback(currentValue, index, array));
  }, []);
}

const flatMapWithIndexArray = [1, 2, 3];
const flatMappedWithIndex = customFlatMapWithIndex(
  flatMapWithIndexArray,
  (num, index) =&gt; [num, num * 2 + index]
);
console.log(&quot;75. 使用 reduce 实现 flatMap with index:&quot;, flatMappedWithIndex); // 输出: [1, 2, 2, 5, 3, 8]

// 76. 使用 reduce 实现 flatMap with index and depth
function customFlatMapWithIndexAndDepth(arr, callback, depth = 1) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    const mappedValue = callback(currentValue, index, array);
    if (Array.isArray(mappedValue) &amp;&amp; depth &gt; 0) {
      return accumulator.concat(
        customFlatMapWithIndexAndDepth(mappedValue, (x, i) =&gt; x, depth - 1)
      );
    }
    return accumulator.concat(mappedValue);
  }, []);
}

const flatMapWithIndexAndDepthArray = [1, 2, 3];
const flatMappedWithIndexAndDepth = customFlatMapWithIndexAndDepth(
  flatMapWithIndexAndDepthArray,
  (num, index) =&gt; [num, [num * 2 + index]],
  2
);
console.log(
  &quot;76. 使用 reduce 实现 flatMap with index and depth:&quot;,
  flatMappedWithIndexAndDepth
); // 输出: [1, [2], 2, [5], 3, [8]]

const flatMappedWithIndexAndDepth2 = customFlatMapWithIndexAndDepth(
  flatMapWithIndexAndDepthArray,
  (num, index) =&gt; [num, [num * 2 + index]],
  1
);
console.log(
  &quot;76. 使用 reduce 实现 flatMap with index and depth (depth 1):&quot;,
  flatMappedWithIndexAndDepth2
); // 输出: [1, [2], 2, [5], 3, [8]]

// 77. 使用 reduce 实现 reduce with initial value as object
function customReduceWithObjectInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithObjectInitialValueArray = [1, 2, 3];
const reduceWithObjectInitialValueResult = customReduceWithObjectInitialValue(
  reduceWithObjectInitialValueArray,
  (acc, curr, index) =&gt; {
    acc.sum += curr;
    acc.count++;
    return acc;
  },
  { sum: 0, count: 0 }
);
console.log(
  &quot;77. 使用 reduce 实现 reduce with initial value as object:&quot;,
  reduceWithObjectInitialValueResult
); // 输出: { sum: 6, count: 3 }

// 78. 使用 reduce 实现 reduceRight with initial value as object
function customReduceRightWithObjectInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithObjectInitialValueArray = [1, 2, 3];
const reduceRightWithObjectInitialValueResult =
  customReduceRightWithObjectInitialValue(
    reduceRightWithObjectInitialValueArray,
    (acc, curr, index) =&gt; {
      acc.sum += curr;
      acc.count++;
      return acc;
    },
    { sum: 0, count: 0 }
  );
console.log(
  &quot;78. 使用 reduce 实现 reduceRight with initial value as object:&quot;,
  reduceRightWithObjectInitialValueResult
); // 输出: { sum: 6, count: 3 }

// 79. 使用 reduce 实现 reduce with initial value as array
function customReduceWithArrayInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithArrayInitialValueArray = [1, 2, 3];
const reduceWithArrayInitialValueResult = customReduceWithArrayInitialValue(
  reduceWithArrayInitialValueArray,
  (acc, curr, index) =&gt; {
    acc.push(curr * 2);
    return acc;
  },
  []
);
console.log(
  &quot;79. 使用 reduce 实现 reduce with initial value as array:&quot;,
  reduceWithArrayInitialValueResult
); // 输出: [2, 4, 6]

// 80. 使用 reduce 实现 reduceRight with initial value as array
function customReduceRightWithArrayInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithArrayInitialValueArray = [1, 2, 3];
const reduceRightWithArrayInitialValueResult =
  customReduceRightWithArrayInitialValue(
    reduceRightWithArrayInitialValueArray,
    (acc, curr, index) =&gt; {
      acc.push(curr * 2);
      return acc;
    },
    []
  );
console.log(
  &quot;80. 使用 reduce 实现 reduceRight with initial value as array:&quot;,
  reduceRightWithArrayInitialValueResult
); // 输出: [6, 4, 2]

// 81. 使用 reduce 实现 reduce with initial value as string
function customReduceWithStringInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithStringInitialValueArray = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];
const reduceWithStringInitialValueResult = customReduceWithStringInitialValue(
  reduceWithStringInitialValueArray,
  (acc, curr) =&gt; acc + curr,
  &quot;&quot;
);
console.log(
  &quot;81. 使用 reduce 实现 reduce with initial value as string:&quot;,
  reduceWithStringInitialValueResult
); // 输出: &quot;abc&quot;

// 82. 使用 reduce 实现 reduceRight with initial value as string
function customReduceRightWithStringInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithStringInitialValueArray = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];
const reduceRightWithStringInitialValueResult =
  customReduceRightWithStringInitialValue(
    reduceRightWithStringInitialValueArray,
    (acc, curr) =&gt; acc + curr,
    &quot;&quot;
  );
console.log(
  &quot;82. 使用 reduce 实现 reduceRight with initial value as string:&quot;,
  reduceRightWithStringInitialValueResult
); // 输出: &quot;cba&quot;

// 83. 使用 reduce 实现 reduce with initial value as number
function customReduceWithNumberInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithNumberInitialValueArray = [1, 2, 3];
const reduceWithNumberInitialValueResult = customReduceWithNumberInitialValue(
  reduceWithNumberInitialValueArray,
  (acc, curr) =&gt; acc + curr,
  0
);
console.log(
  &quot;83. 使用 reduce 实现 reduce with initial value as number:&quot;,
  reduceWithNumberInitialValueResult
); // 输出: 6

// 84. 使用 reduce 实现 reduceRight with initial value as number
function customReduceRightWithNumberInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithNumberInitialValueArray = [1, 2, 3];
const reduceRightWithNumberInitialValueResult =
  customReduceRightWithNumberInitialValue(
    reduceRightWithNumberInitialValueArray,
    (acc, curr) =&gt; acc + curr,
    0
  );
console.log(
  &quot;84. 使用 reduce 实现 reduceRight with initial value as number:&quot;,
  reduceRightWithNumberInitialValueResult
); // 输出: 6

// 85. 使用 reduce 实现 reduce with initial value as boolean
function customReduceWithBooleanInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithBooleanInitialValueArray = [true, true, false];
const reduceWithBooleanInitialValueResult = customReduceWithBooleanInitialValue(
  reduceWithBooleanInitialValueArray,
  (acc, curr) =&gt; acc &amp;&amp; curr,
  true
);
console.log(
  &quot;85. 使用 reduce 实现 reduce with initial value as boolean:&quot;,
  reduceWithBooleanInitialValueResult
); // 输出: false

const reduceWithBooleanInitialValueResult2 =
  customReduceWithBooleanInitialValue(
    [true, true, true],
    (acc, curr) =&gt; acc &amp;&amp; curr,
    true
  );
console.log(
  &quot;85. 使用 reduce 实现 reduce with initial value as boolean (true):&quot;,
  reduceWithBooleanInitialValueResult2
); // 输出: true

// 86. 使用 reduce 实现 reduceRight with initial value as boolean
function customReduceRightWithBooleanInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithBooleanInitialValueArray = [true, true, false];
const reduceRightWithBooleanInitialValueResult =
  customReduceRightWithBooleanInitialValue(
    reduceRightWithBooleanInitialValueArray,
    (acc, curr) =&gt; acc &amp;&amp; curr,
    true
  );
console.log(
  &quot;86. 使用 reduce 实现 reduceRight with initial value as boolean:&quot;,
  reduceRightWithBooleanInitialValueResult
); // 输出: false

const reduceRightWithBooleanInitialValueResult2 =
  customReduceRightWithBooleanInitialValue(
    [true, true, true],
    (acc, curr) =&gt; acc &amp;&amp; curr,
    true
  );
console.log(
  &quot;86. 使用 reduce 实现 reduceRight with initial value as boolean (true):&quot;,
  reduceRightWithBooleanInitialValueResult2
); // 输出: true

// 87. 使用 reduce 实现 reduce with initial value as null
function customReduceWithNullInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithNullInitialValueArray = [1, 2, 3];
const reduceWithNullInitialValueResult = customReduceWithNullInitialValue(
  reduceWithNullInitialValueArray,
  (acc, curr) =&gt; (acc === null ? curr : acc + curr),
  null
);
console.log(
  &quot;87. 使用 reduce 实现 reduce with initial value as null:&quot;,
  reduceWithNullInitialValueResult
); // 输出: 6

// 88. 使用 reduce 实现 reduceRight with initial value as null
function customReduceRightWithNullInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithNullInitialValueArray = [1, 2, 3];
const reduceRightWithNullInitialValueResult =
  customReduceRightWithNullInitialValue(
    reduceRightWithNullInitialValueArray,
    (acc, curr) =&gt; (acc === null ? curr : acc + curr),
    null
  );
console.log(
  &quot;88. 使用 reduce 实现 reduceRight with initial value as null:&quot;,
  reduceRightWithNullInitialValueResult
); // 输出: 6

// 89. 使用 reduce 实现 reduce with initial value as undefined
function customReduceWithUndefinedInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceWithUndefinedInitialValueArray = [1, 2, 3];
const reduceWithUndefinedInitialValueResult =
  customReduceWithUndefinedInitialValue(
    reduceWithUndefinedInitialValueArray,
    (acc, curr) =&gt; (acc === undefined ? curr : acc + curr),
    undefined
  );
console.log(
  &quot;89. 使用 reduce 实现 reduce with initial value as undefined:&quot;,
  reduceWithUndefinedInitialValueResult
); // 输出: 6

// 90. 使用 reduce 实现 reduceRight with initial value as undefined
function customReduceRightWithUndefinedInitialValue(
  arr,
  callback,
  initialValue
) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const reduceRightWithUndefinedInitialValueArray = [1, 2, 3];
const reduceRightWithUndefinedInitialValueResult =
  customReduceRightWithUndefinedInitialValue(
    reduceRightWithUndefinedInitialValueArray,
    (acc, curr) =&gt; (acc === undefined ? curr : acc + curr),
    undefined
  );
console.log(
  &quot;90. 使用 reduce 实现 reduceRight with initial value as undefined:&quot;,
  reduceRightWithUndefinedInitialValueResult
); // 输出: 6

// 91. 使用 reduce 实现 reduce with initial value as symbol
function customReduceWithSymbolInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const symbol1 = Symbol(&quot;test&quot;);
const symbol2 = Symbol(&quot;test2&quot;);
const reduceWithSymbolInitialValueArray = [symbol1, symbol2];
const reduceWithSymbolInitialValueResult = customReduceWithSymbolInitialValue(
  reduceWithSymbolInitialValueArray,
  (acc, curr) =&gt; (acc === null ? curr : acc),
  null
);
console.log(
  &quot;91. 使用 reduce 实现 reduce with initial value as symbol:&quot;,
  reduceWithSymbolInitialValueResult
); // 输出: Symbol(test)

// 92. 使用 reduce 实现 reduceRight with initial value as symbol
function customReduceRightWithSymbolInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const symbol3 = Symbol(&quot;test3&quot;);
const symbol4 = Symbol(&quot;test4&quot;);
const reduceRightWithSymbolInitialValueArray = [symbol3, symbol4];
const reduceRightWithSymbolInitialValueResult =
  customReduceRightWithSymbolInitialValue(
    reduceRightWithSymbolInitialValueArray,
    (acc, curr) =&gt; (acc === null ? curr : acc),
    null
  );
console.log(
  &quot;92. 使用 reduce 实现 reduceRight with initial value as symbol:&quot;,
  reduceRightWithSymbolInitialValueResult
); // 输出: Symbol(test3)

// 93. 使用 reduce 实现 reduce with initial value as function
function customReduceWithFunctionInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const func1 = () =&gt; 1;
const func2 = () =&gt; 2;
const reduceWithFunctionInitialValueArray = [func1, func2];
const reduceWithFunctionInitialValueResult =
  customReduceWithFunctionInitialValue(
    reduceWithFunctionInitialValueArray,
    (acc, curr) =&gt; (acc === null ? curr : () =&gt; acc() + curr()),
    null
  );
console.log(
  &quot;93. 使用 reduce 实现 reduce with initial value as function:&quot;,
  reduceWithFunctionInitialValueResult()
); // 输出: 3

// 94. 使用 reduce 实现 reduceRight with initial value as function
function customReduceRightWithFunctionInitialValue(
  arr,
  callback,
  initialValue
) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const func3 = () =&gt; 3;
const func4 = () =&gt; 4;
const reduceRightWithFunctionInitialValueArray = [func3, func4];
const reduceRightWithFunctionInitialValueResult =
  customReduceRightWithFunctionInitialValue(
    reduceRightWithFunctionInitialValueArray,
    (acc, curr) =&gt; (acc === null ? curr : () =&gt; acc() + curr()),
    null
  );
console.log(
  &quot;94. 使用 reduce 实现 reduceRight with initial value as function:&quot;,
  reduceRightWithFunctionInitialValueResult()
); // 输出: 7

// 95. 使用 reduce 实现 reduce with initial value as date
function customReduceWithDateInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const date1 = new Date(&quot;2024-01-01&quot;);
const date2 = new Date(&quot;2024-01-02&quot;);
const reduceWithDateInitialValueArray = [date1, date2];
const reduceWithDateInitialValueResult = customReduceWithDateInitialValue(
  reduceWithDateInitialValueArray,
  (acc, curr) =&gt;
    acc === null ? curr : new Date(acc.getTime() + curr.getTime()),
  null
);
console.log(
  &quot;95. 使用 reduce 实现 reduce with initial value as date:&quot;,
  reduceWithDateInitialValueResult
); // 输出: 2024-01-03T00:00:00.000Z

// 96. 使用 reduce 实现 reduceRight with initial value as date
function customReduceRightWithDateInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const date3 = new Date(&quot;2024-01-03&quot;);
const date4 = new Date(&quot;2024-01-04&quot;);
const reduceRightWithDateInitialValueArray = [date3, date4];
const reduceRightWithDateInitialValueResult =
  customReduceRightWithDateInitialValue(
    reduceRightWithDateInitialValueArray,
    (acc, curr) =&gt;
      acc === null ? curr : new Date(acc.getTime() + curr.getTime()),
    null
  );
console.log(
  &quot;96. 使用 reduce 实现 reduceRight with initial value as date:&quot;,
  reduceRightWithDateInitialValueResult
); // 输出: 2024-01-07T00:00:00.000Z

// 97. 使用 reduce 实现 reduce with initial value as regex
function customReduceWithRegexInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const regex1 = /a/g;
const regex2 = /b/g;
const reduceWithRegexInitialValueArray = [regex1, regex2];
const reduceWithRegexInitialValueResult = customReduceWithRegexInitialValue(
  reduceWithRegexInitialValueArray,
  (acc, curr) =&gt;
    acc === null ? curr : new RegExp(acc.source + curr.source, &quot;g&quot;),
  null
);
console.log(
  &quot;97. 使用 reduce 实现 reduce with initial value as regex:&quot;,
  reduceWithRegexInitialValueResult
); // 输出: /ab/g

// 98. 使用 reduce 实现 reduceRight with initial value as regex
function customReduceRightWithRegexInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const regex3 = /c/g;
const regex4 = /d/g;
const reduceRightWithRegexInitialValueArray = [regex3, regex4];
const reduceRightWithRegexInitialValueResult =
  customReduceRightWithRegexInitialValue(
    reduceRightWithRegexInitialValueArray,
    (acc, curr) =&gt;
      acc === null ? curr : new RegExp(acc.source + curr.source, &quot;g&quot;),
    null
  );
console.log(
  &quot;98. 使用 reduce 实现 reduceRight with initial value as regex:&quot;,
  reduceRightWithRegexInitialValueResult
); // 输出: /dc/g

// 99. 使用 reduce 实现 reduce with initial value as set
function customReduceWithSetInitialValue(arr, callback, initialValue) {
  return arr.reduce((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const set1 = new Set([1, 2]);
const set2 = new Set([3, 4]);
const reduceWithSetInitialValueArray = [set1, set2];
const reduceWithSetInitialValueResult = customReduceWithSetInitialValue(
  reduceWithSetInitialValueArray,
  (acc, curr) =&gt; {
    if (acc === null) return curr;
    curr.forEach((item) =&gt; acc.add(item));
    return acc;
  },
  null
);
console.log(
  &quot;99. 使用 reduce 实现 reduce with initial value as set:&quot;,
  reduceWithSetInitialValueResult
); // 输出: Set(4) {1, 2, 3, 4}

// 100. 使用 reduce 实现 reduceRight with initial value as set
function customReduceRightWithSetInitialValue(arr, callback, initialValue) {
  return arr.reduceRight((accumulator, currentValue, index, array) =&gt; {
    return callback(accumulator, currentValue, index, array);
  }, initialValue);
}

const set3 = new Set([5, 6]);
const set4 = new Set([7, 8]);
const reduceRightWithSetInitialValueArray = [set3, set4];
const reduceRightWithSetInitialValueResult =
  customReduceRightWithSetInitialValue(
    reduceRightWithSetInitialValueArray,
    (acc, curr) =&gt; {
      if (acc === null) return curr;
      curr.forEach((item) =&gt; acc.add(item));
      return acc;
    },
    null
  );
console.log(
  &quot;100. 使用 reduce 实现 reduceRight with initial value as set:&quot;,
  reduceRightWithSetInitialValueResult
); // 输出: Set(4) {5, 6, 7, 8}
</code></pre>

        </article>
      </main>

      <!-- Table of Contents Sidebar -->
      <aside class="toc-sidebar">
        <div class="toc-header">
          <h3>Table of Contents</h3>
        </div>
        <div class="toc-content" id="tocContent">
          <!-- TOC will be generated dynamically -->
        </div>
      </aside>
    </div>

    <div class="body_bg"></div>
    <div class="zoom-overlay"></div>

    <button id="backToTop" class="back-to-top" aria-label="Back to top">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M12 19V5M5 12l7-7 7 7" />
      </svg>
    </button>

    <style>
      .zoom-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        z-index: 1000;
        cursor: zoom-out;
      }
      .zoomed-image {
        position: fixed;
        z-index: 1001;
        will-change: transform;
        cursor: zoom-out;
        max-width: 90vw;
        max-height: 90vh;
        object-fit: contain;
      }
      .back-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        border-radius: 100%;
        background-color: #07a;
        border: none;
        color: #333;
        text-decoration: none;
        font-size: 14px;
        margin-bottom: 16px;
        cursor: pointer;
        transition: background-color 0.2s;
        position: fixed !important;
        top: 30px;
        right: 30px;
        z-index: 10;
        display: none;
      }
      .back-button svg {
        width: 50%;
        height: 50%;
      }
      .back-button:hover {
        opacity: 0.8;
      }
      .layout {
        position: relative;
        z-index: 1;
      }
      .back-to-top {
        position: fixed;
        bottom: 2rem;
        right: 340px;
        background: linear-gradient(
          135deg,
          var(--accent),
          rgba(59, 130, 246, 0.8)
        );
        color: white;
        border: none;
        width: 3rem;
        height: 3rem;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
      }

      .back-to-top svg {
        width: 1.5rem;
        height: 1.5rem;
        stroke: currentColor;
        transition: transform 0.3s ease;
      }

      .back-to-top:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(59, 130, 246, 0.3);
        background: linear-gradient(135deg, var(--accent), #2563eb);
      }

      .back-to-top:hover svg {
        transform: translateY(-2px);
      }

      .dark .back-to-top {
        background: linear-gradient(135deg, #4b5563, #1f2937);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .dark .back-to-top:hover {
        background: linear-gradient(135deg, #4b5563, #111827);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
      }
      @media screen and (max-width: 768px) {
        .back-to-top {
          right: 15px;
          bottom: 15px;
          width: 36px;
          height: 36px;
        }
      }

      @media screen and (max-width: 480px) {
        .back-to-top {
          right: 12px;
          bottom: 12px;
          width: 32px;
          height: 32px;
        }
      }
    </style>
    <script defer src="../js/prism.min.js"></script>
    <script>
      // Sidebar Toggle
      const toggleBtn = document.getElementById("toggleSidebar");
      const sidebar = document.querySelector(".sidebar");
      const mainContent = document.querySelector(".main-content");

      function toggleSidebar() {
        sidebar.classList.toggle("hidden");
        // Store sidebar state in localStorage
        localStorage.setItem(
          "sidebarHidden",
          sidebar.classList.contains("hidden")
        );
      }

      toggleBtn.addEventListener("click", toggleSidebar);

      // Keyboard shortcut (Ctrl + B)
      window.addEventListener("keydown", (e) => {
        if (e.ctrlKey && e.key === "b") {
          e.preventDefault(); // Prevent browser's default behavior
          toggleSidebar();
        }
      });

      // Restore sidebar state from localStorage
      document.addEventListener("DOMContentLoaded", () => {
        const sidebarHidden = localStorage.getItem("sidebarHidden") === "true";
        if (sidebarHidden) {
          sidebar.classList.add("hidden");
        }
      });

      // Generate Table of Contents
      function generateTOC() {
        const article = document.querySelector(".content-body");
        const headings = article.querySelectorAll("h1, h2, h3, h4");
        const tocContent = document.getElementById("tocContent");
        const toc = document.createElement("ul");

        headings.forEach((heading, index) => {
          const id = `heading-${index}`;
          heading.id = id;

          const li = document.createElement("li");
          const a = document.createElement("a");
          a.href = `#${id}`;
          a.textContent = heading.textContent;
          a.className = `toc-level-${heading.tagName.toLowerCase()}`;

          li.appendChild(a);
          toc.appendChild(li);
        });

        tocContent.appendChild(toc);
      }

      // Initialize TOC
      document.addEventListener("DOMContentLoaded", generateTOC);

      // Image zoom with FLIP animation
      const overlay = document.querySelector(".zoom-overlay");
      let activeImage = null;

      document.querySelectorAll("img").forEach((img) => {
        if (img.closest("a")) return; // Skip images that are inside links
        img.style.cursor = "zoom-in";
        img.addEventListener("click", handleImageClick);
      });

      function handleImageClick(event) {
        const img = event.target;

        if (activeImage) {
          // If an image is already zoomed, unzoom it
          unzoomImage();
          return;
        }

        // Get the initial position and size
        const rect = img.getBoundingClientRect();
        const first = {
          x: rect.left,
          y: rect.top,
          width: rect.width,
          height: rect.height,
        };

        // Create a clone of the image
        const clone = img.cloneNode();
        clone.classList.add("zoomed-image");
        document.body.appendChild(clone);

        // Position the clone exactly over the original
        clone.style.position = "fixed";
        clone.style.left = `${first.x}px`;
        clone.style.top = `${first.y}px`;
        clone.style.width = `${first.width}px`;
        clone.style.height = `${first.height}px`;
        clone.style.margin = "0";
        clone.style.transformOrigin = "top left";

        // Show the overlay
        overlay.style.display = "block";

        // Calculate the final position and scale
        const viewportWidth = window.innerWidth;
        const viewportHeight = window.innerHeight;
        const targetWidth = Math.min(img.naturalWidth, viewportWidth * 0.9);
        const targetHeight = Math.min(img.naturalHeight, viewportHeight * 0.9);
        const scaleX = targetWidth / first.width;
        const scaleY = targetHeight / first.height;
        const scale = Math.min(scaleX, scaleY);

        const last = {
          width: first.width * scale,
          height: first.height * scale,
        };
        last.x = (viewportWidth - last.width) / 2;
        last.y = (viewportHeight - last.height) / 2;

        // Calculate and apply the transform
        const dx = last.x - first.x;
        const dy = last.y - first.y;

        requestAnimationFrame(() => {
          clone.style.transform = `translate(${dx}px, ${dy}px) scale(${scale})`;
          clone.style.transition = "transform 0.3s ease-out";
        });

        activeImage = { original: img, clone: clone };

        // Add click handlers for closing
        clone.addEventListener("click", unzoomImage);
        overlay.addEventListener("click", unzoomImage);
      }

      function unzoomImage() {
        if (!activeImage) return;

        const { original, clone } = activeImage;
        const rect = original.getBoundingClientRect();

        // Animate back to the original position
        clone.style.transform = `translate(0, 0) scale(1)`;

        // Clean up after the animation
        clone.addEventListener(
          "transitionend",
          () => {
            clone.remove();
            overlay.style.display = "none";
          },
          { once: true }
        );

        activeImage = null;
      }

      // 监听 ctrl + b
      window.addEventListener("keydown", (e) => {
        const leftDom = document.querySelector(".sidebar");
        if (e.ctrlKey && e.key === "b") {
          leftDom.classList.toggle("hidden");
        }
      });

      // Modal
      // const modal = document.getElementById("myModal");
      // const modalContent = modal.querySelector(".modal-content");
      // const openModal = document.getElementById("openModal");
      // const close = modal.querySelector(".close");

      // openModal.addEventListener("click", () => {
      //     modal.style.display = "block";
      // });

      // close.addEventListener("click", () => {
      //     modal.style.display = "none";
      // });

      // window.addEventListener("click", (e) => {
      //     if (e.target === modal) {
      //         modal.style.display = "none";
      //     }
      // });

      // Back to top button
      const backToTop = document.getElementById("backToTop");
      window.addEventListener("scroll", () => {
        if (window.scrollY > 200) {
          backToTop.style.display = "block";
        } else {
          backToTop.style.display = "none";
        }
      });

      backToTop.addEventListener("click", () => {
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      // Theme toggle
      document.addEventListener("DOMContentLoaded", () => {
        const themeToggle = document.getElementById("themeToggle");
        const html = document.documentElement;
        const prismTheme = document.getElementById("prismTheme");

        // Function to update theme and stylesheet
        function updateTheme(theme) {
          html.className = theme;
          prismTheme.href = `../css/prism${theme === "dark" ? "2" : ""}.css`;
          localStorage.setItem("theme", theme);
        }

        // Check for saved theme preference
        const savedTheme = localStorage.getItem("theme") || "light";
        updateTheme(savedTheme);

        themeToggle.addEventListener("click", () => {
          const currentTheme = html.className;
          const newTheme = currentTheme === "light" ? "dark" : "light";
          updateTheme(newTheme);
        });
      });
    </script>
  </body>
</html>
